function tpassword_start(e){$(`#${e} button`).click(function(){var e=$(this).find("i");var t=$(this).prev();e.toggleClass("fa-eye-slash");e.toggleClass("fa-eye");if(t.attr("type")=="text"){t.attr("type","password")}else{t.attr("type","text")}})}function tdialog_start(e,t){let a=new bootstrap.Modal(e,{keyboard:true});a.show();if(typeof t!="undefined"){$(e).on("hidden.bs.modal",function(){t();tdialog_close(e.substring(1))})}else{$(e).on("hidden.bs.modal",function(){tdialog_close(e.substring(1))})}$(e+" .byselect2:not([multiple])").each(function(){var e,t;e=$(this).data("select2-options");t=$(this).closest(".modal");if(t.length){e["dropdownParent"]=t}$(this).select2(e)});$(e).on("hide.bs.modal",function(){document.activeElement.blur()})}function tdialog_close(e){$("#"+e).modal("hide");setTimeout(function(){$("#"+e).remove()},300)}function tjquerydialog_start(e,t,a,i,n,r,o,l,s,c,d,f,u){if($(e).parent().attr("role")=="window-wrapper"){var p="#"+$(e).parent().attr("id")}else{var p="body"}var _="Close";if(typeof Application.translation!=="undefined"&&typeof Application.translation[Adianti.language]["close"]!=="undefined"){_=Application.translation[Adianti.language]["close"]}$(e).dialog({modal:t,stack:false,zIndex:2e3,draggable:a,closeText:_,resizable:i,closeOnEscape:f,height:r,width:n,appendTo:p,dialogClass:u,beforeClose:function(){if(typeof d=="function"){d();return false}return true},close:function(e,t){$(this).remove();$(".tooltip.fade").remove();var a=$(this).attr("name");$("[window_name="+a+"]").remove()},buttons:c});$(".ui-dialog").last().focus();$(e).closest(".ui-dialog").css({zIndex:s});$(".ui-widget-overlay").css({zIndex:100});if(o>0){$(e).closest(".ui-dialog").css({top:o+"px"})}if(l>0){$(e).closest(".ui-dialog").css({left:l+"px"})}}function tjquerydialog_block_ui(){$(document).ready(function(){$(".ui-dialog").css("pointer-events","none");$(".ui-dialog-content").css("opacity","0.5")})}function tjquerydialog_unblock_ui(){$(".ui-dialog").css("pointer-events","all");$(".ui-dialog-content").css("opacity","")}function tform_send_data(i,e,t,n,a){if(parseInt(a)>0){setTimeout(function(){tform_send_data(i,e,t,n,0)},a);return}try{if(e.substr(0,1)=="#"){var r=$(e);var o=[];var l=[]}else{var r=$("form[name="+i+"] [name='"+e+"']");var o=$("form[name="+i+"] [name='"+e+"[]']");var l=$("form[name="+i+"] [widget='tmultifile'][name='file_"+e+"[]']")}if(r.length||o.length||l){if(typeof Adianti.formEventsCounter=="undefined"||Number.isNaN(Adianti.formEventsCounter)){Adianti.formEventsCounter=0}if(Adianti.formEventsCounter==0){if(l.length){try{l[0].tmultifile.send_data(JSON.parse(t))}catch(e){l[0].tmultifile.setValue(t)}}else if(r.length){if(r.attr("widget")=="thtmleditor"){r.summernote("code",t)}else if(r.attr("widget")=="tcolor"){if(t){r.data("picker").setColor(t)}else{r.data("picker").setColor(null)}}else if(r.attr("widget")=="tarrowstep"){if(t){tarrowstep_set_current(r[0].name,t)}else{tarrowstep_clear(r[0].name)}}else if(r.attr("widget")=="tdate"){tdate_set_value("#"+r.attr("id"),t)}else if(r.attr("widget")=="timagecropper"){r[0].timagecropper.setValue(t)}else if(r.attr("widget")=="tfile"){r[0].tfile.setValue(t)}else if(r.attr("role")=="tcombosearch"){if(r.val()!==t){var s=function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}};r.select2({templateResult:s,templateSelection:s}).val(t).trigger("change.select2")}}else if(r.attr("widget")=="tdbuniquesearch"){var c=n;tdbuniquesearch_set_value(i,e,t,function(){if(c){if(r.attr("exitaction")){tform_events_hang_exec(r.attr("exitaction"))}if(r.attr("changeaction")){tform_events_hang_exec(r.attr("changeaction"))}}});n=false}else if(r.attr("component")=="multisearch"){if(t){var s=function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}};r.select2({templateResult:s,templateSelection:s}).val(t).trigger("change.select2")}}else if(r.attr("type")=="radio"||r.attr("type")=="checkbox"){r.prop("checked",false);if(t){var d=r.filter('[value="'+t+'"]').prop("checked",true);if(d.parent().prop("tagName")=="LABEL"){d.parent().parent().find("label").removeClass("active");d.parent().toggleClass("active")}}else{if(r.parent().prop("tagName")=="LABEL"){r.parent().parent().find("label").removeClass("active")}}}else{r.val(t)}if(n){if(r.attr("exitaction")){tform_events_hang_exec(r.attr("exitaction"))}if(r.attr("changeaction")){tform_events_hang_exec(r.attr("changeaction"))}}}else if(o.length){if(o.attr("type")=="checkbox"){o.prop("checked",false);if(t){o.parent().parent().find("label").removeClass("active");var f=JSON.parse(t);$.each(f,function(e,t){var a=o.filter('[value="'+t+'"]').prop("checked",true);if(a.parent().prop("tagName")=="LABEL"){a.parent().toggleClass("active")}})}else{o.parent().parent().find("label").removeClass("active")}}else if(o.attr("component")=="multientry"){if(t){o.empty();var u=JSON.parse(t);$.each(u,function(e,t){o.append($("<option/>").val(t).text(t))});o.val(u).trigger("change.select2")}}else if(o.attr("component")=="multisearch"&&o.attr("widget")!=="tuniquesearch"){if(t){var u=JSON.parse(t);var s=function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}};if(o.attr("widget")=="tmultisearch"){o.select2({templateResult:s,templateSelection:s}).val(u).trigger("change.select2")}else if(o.attr("widget")=="tdbmultisearch"){var p=n;tdbmultisearch_set_value(i,e,t,function(){if(p){if(o.attr("exitaction")){tform_events_hang_exec(o.attr("exitaction"))}if(o.attr("changeaction")){tform_events_hang_exec(o.attr("changeaction"))}}});n=false}else{$.each(u,function(e,t){var a=$($(o)[e]).attr("id");tform_send_data(i,"#"+a,t,n)});n=false}}}else if(o.length){if(t){var u=JSON.parse(t);$(o).find("option").prop("selected",false);if(["tselect","tmulticombo","tdbmulticombo"].includes(o.attr("widget"))&&o.length==1){$.each(u,function(e,t){$(o).find("option").filter('[value="'+t+'"]').prop("selected",true)})}else{$.each(u,function(e,t){var a=$($(o)[e]).attr("id");tform_send_data(i,"#"+a,t,n)});n=false}if(["tmulticombo","tdbmulticombo"].includes($(o).attr("widget"))){$(o).multiselect("reload");$(o).next(".ms-options-wrap").width($(o).data("size"))}}}if(n){if(o.attr("exitaction")){tform_events_hang_exec(o.attr("exitaction"))}if(o.attr("changeaction")){tform_events_hang_exec(o.attr("changeaction"))}}}}else{tform_events_queue_push(function(){tform_send_data(i,e,t,n)})}}}catch(e){console.log(e)}}function tform_send_data_by_id(e,t,a,i,n){if($("form[name="+e+"] [id="+t+"]").length>0){tform_send_data(e,"#"+t,a,i,n)}}function tform_events_hang_exec(e){if(typeof Adianti.formEventsCounter=="undefined"||Number.isNaN(Adianti.formEventsCounter)){Adianti.formEventsCounter=0}Adianti.formEventsCounter++;e=e.replace("'callback'","tform_decrease_events_counter");Function(e)()}function tform_events_stop(e){Adianti.formEventsStop=e}function tform_events_queue_push(e){if(typeof Adianti.formEventsQueue=="undefined"){Adianti.formEventsQueue=new Array}Adianti.formEventsQueue.push(e);setTimeout(tform_process_events_queue,100)}function tform_process_events_queue(){if(typeof Adianti.formEventsCounter=="undefined"||Number.isNaN(Adianti.formEventsCounter)){Adianti.formEventsCounter=0}if(Adianti.formEventsCounter==0&&Adianti.formEventsQueue.length>0){next=Adianti.formEventsQueue.shift();next()}if(Adianti.formEventsQueue.length>0){setTimeout(tform_process_events_queue,100)}else{if(typeof Adianti.formEventsStop=="function"){Adianti.formEventsStop();Adianti.formEventsStop=null}}}function tform_decrease_events_counter(){if(typeof Adianti.formEventsCounter=="undefined"||Number.isNaN(Adianti.formEventsCounter)){Adianti.formEventsCounter=0}if(Adianti.formEventsCounter>0){Adianti.formEventsCounter--}}function tform_send_data_aggregate(e,t,a,i){try{if($("form[name="+e+"] [name="+t+"]").val()==""){$("form[name="+e+"] [name="+t+"]").val(a)}else{current_value=$("form[name="+e+"] [name="+t+"]").val();$("form[name="+e+"] [name="+t+"]").val(current_value+", "+a)}}catch(e){console.log(e)}}function tform_fire_field_actions(e,t){if($("form[name="+e+"] [name="+t+"]").attr("exitaction")){tform_events_hang_exec($("form[name="+e+"] [name="+t+"]").attr("exitaction"))}if($("form[name="+e+"] [name="+t+"]").attr("changeaction")){tform_events_hang_exec($("form[name="+e+"] [name="+t+"]").attr("changeaction"))}}function tform_hide_field(e,t,a){if(typeof a=="undefined"){$("#"+e+' [name="'+t+'"]').closest(".tformrow").hide("fast")}else{$("#"+e+' [name="'+t+'"]').closest(".tformrow").hide(a)}}function tform_show_field(e,t,a){if(typeof a=="undefined"){$("#"+e+' [name="'+t+'"]').closest(".tformrow").show("fast")}else{$("#"+e+' [name="'+t+'"]').closest(".tformrow").show(a)}}function tform_disable_field(i,n){try{let e=tfield_get_selector(i,n);if($(e).attr("widget")=="tentry"){tfield_disable_field(i,n)}else if($(e).attr("widget")=="tpassword"){tfield_disable_field(i,n)}else if($(e).attr("widget")=="ttext"){tfield_disable_field(i,n)}else if($(e).attr("widget")=="tbarcodeinputreader"){tfield_disable_field(i,n)}else if($(e).attr("widget")=="tqrcodeinputreader"){tfield_disable_field(i,n)}else if($(e).attr("widget")=="tcolor"){tcolor_disable_field(i,n)}else if($(e).attr("widget")=="ticon"){ticon_disable_field(i,n)}else if($(e).attr("widget")=="tfile"){tfile_disable_field(i,n)}else if($(e).attr("widget")=="tdate"){tdate_disable_field(i,n)}else if($(e).attr("widget")=="tdatetime"){tdate_disable_field(i,n)}else if($(e).attr("widget")=="ttime"){tdate_disable_field(i,n)}else if($(e).attr("widget")=="tseekbutton"){tseekbutton_disable_field(i,n)}else if($(e).attr("widget")=="tbutton"){tbutton_disable_field(i,n)}else if($(e).attr("widget")=="tchecklist"){tchecklist_disable_field(name)}else if($(e).attr("widget")=="tradiobutton"){tradiogroup_disable_field(i,n)}else if($(e).attr("widget")=="tspinner"){tspinner_disable_field(i,n)}else if($(e).attr("widget")=="tdbuniquesearch"){tmultisearch_disable_field(i,n,"")}else if($(e).attr("widget")=="tlikertscale"){tlikertscale_disable_field(i,n)}else if($(e).attr("widget")=="thtmleditor"){thtmleditor_disable_field(i,n)}else if($(e).attr("widget")=="tcombo"){tcombo_disable_field(i,n)}else if($(e).attr("widget")=="tslider"){tslider_disable_field(i,n)}else if($(e).attr("widget")=="tfieldlist"){tfieldlist_disable_field(name)}else if($(e).attr("widget")=="tsortlist"){tsortlist_disable_field(i,n)}else if($(e).attr("widget")=="tarrowstep"){tarrowstep_disable_field(name)}else if($("form[name="+i+"] [checkgroup="+n+"]").length>0){tcheckgroup_disable_field(i,n)}let t=tfield_get_selector(i,n+"[]");console.log(t);if($(t).attr("widget")=="tselect"){tselect_disable_field(i,n)}else if($(t).attr("widget")=="tmulticombo"){tmulticombo_disable_field(i,n)}else if($(t).attr("widget")=="tdbmulticombo"){tmulticombo_disable_field(i,n)}else if($(t).attr("widget")=="tdbmultisearch"){tmultisearch_disable_field(i,n,"")}else if($(t).attr("widget")=="tmultisearch"){tmultisearch_disable_field(i,n,"")}else if($(t).attr("widget")=="tdbmultisearch"){tmultisearch_disable_field(i,n,"")}let a=tfield_get_selector(i,"file_"+n+"[]");if($(a).attr("widget")=="tmultifile"){tmultifile_disable_field(i,n)}}catch(e){console.log(e)}}function tform_enable_field(i,n){try{let e=tfield_get_selector(i,n);if($(e).attr("widget")=="tentry"){tfield_enable_field(i,n)}else if($(e).attr("widget")=="tpassword"){tfield_enable_field(i,n)}else if($(e).attr("widget")=="ttext"){tfield_enable_field(i,n)}else if($(e).attr("widget")=="tbarcodeinputreader"){tfield_enable_field(i,n)}else if($(e).attr("widget")=="tqrcodeinputreader"){tfield_enable_field(i,n)}else if($(e).attr("widget")=="tcolor"){tcolor_enable_field(i,n)}else if($(e).attr("widget")=="ticon"){ticon_enable_field(i,n)}else if($(e).attr("widget")=="tfile"){tfile_enable_field(i,n)}else if($(e).attr("widget")=="tdate"){tdate_enable_field(i,n)}else if($(e).attr("widget")=="tdatetime"){tdate_enable_field(i,n)}else if($(e).attr("widget")=="ttime"){tdate_enable_field(i,n)}else if($(e).attr("widget")=="tseekbutton"){tseekbutton_enable_field(i,n)}else if($(e).attr("widget")=="tbutton"){tbutton_enable_field(i,n)}else if($(e).attr("widget")=="tchecklist"){tchecklist_enable_field(name)}else if($(e).attr("widget")=="tradiobutton"){tradiogroup_enable_field(i,n)}else if($(e).attr("widget")=="tspinner"){tspinner_enable_field(i,n)}else if($(e).attr("widget")=="tdbuniquesearch"){tmultisearch_enable_field(i,n)}else if($(e).attr("widget")=="tlikertscale"){tlikertscale_enable_field(i,n)}else if($(e).attr("widget")=="thtmleditor"){thtmleditor_enable_field(i,n)}else if($(e).attr("widget")=="tcombo"){tcombo_enable_field(i,n)}else if($(e).attr("widget")=="tslider"){tslider_enable_field(i,n)}else if($(e).attr("widget")=="tfieldlist"){tfieldlist_enable_field(name)}else if($(e).attr("widget")=="tsortlist"){tsortlist_enable_field(i,n)}else if($(e).attr("widget")=="tarrowstep"){tarrowstep_enable_field(name)}else if($("form[name="+i+"] [checkgroup="+n+"]").length>0){tcheckgroup_enable_field(i,n)}let t=tfield_get_selector(i,n+"[]");if($(t).attr("widget")=="tselect"){tselect_enable_field(i,n)}else if($(t).attr("widget")=="tmulticombo"){tmulticombo_enable_field(i,n)}else if($(t).attr("widget")=="tdbmulticombo"){tmulticombo_enable_field(i,n)}else if($(t).attr("widget")=="tmultisearch"){tmultisearch_enable_field(i,n)}else if($(t).attr("widget")=="tmultisearch"){tmultisearch_enable_field(i,n)}else if($(t).attr("widget")=="tdbmultisearch"){tmultisearch_enable_field(i,n)}else if($(t).attr("widget")=="tmultifile"){tmultifile_enable_field(i,n)}let a=tfield_get_selector(i,"file_"+n+"[]");if($(a).attr("widget")=="tmultifile"){tmultifile_enable_field(i,n)}}catch(e){console.log(e)}}function ttable_clone_previous_row(e){var t=$(e).closest("table");var a=t.find("tbody tr:last");var i=a.clone();tfieldlist_reset_fields(i,true);t.find("tbody").append(i);ttable_reset_counter(t)}function ttable_clone_row(e){var t=$(e).closest("tr");var a=$(e).closest("table");var i=t.prev();var n=t.clone();tfieldlist_reset_fields(n,false);t.after($(n));ttable_reset_counter(a)}function ttable_reset_counter(e){var i=0;var t=$(e).find("tr").each(function(e,t){var a=$(t).find("input,select");$(t).data("row",i);if(a.length>0){$.each(a,function(e,t){$(t).data("row",i)});i++}})}function ttable_remove_row(i){setTimeout(function(){var e=$(i).closest("table");var t=e.find("tbody").find("tr:visible").length;tr=$(i).closest("tr");if(t==1){var a=tr.clone();tfieldlist_reset_fields(a,true);tr.after($(a));tr.remove()}else{tr.remove()}ttable_reset_counter(e)},10)}function ttable_remove_row_by_id(e,t){$("#"+e).find("tr[id="+t+"]").remove()}function ttable_show_row(e,t){$("#"+e).find("tr#"+t).show()}function ttable_hide_row(e,t){$("#"+e).find("tr#"+t).hide()}function ttable_sortable_rows(e,t,a){$(document).ready(function(){$("#"+e+" tbody").sortable({handle:t,deactivate:a})})}function ttable_get_column_values(e,t){return $("#"+e+" tbody").find("tr").find("td:nth-child("+t+")").map(function(){return this.innerText}).get().join(",")}function ttable_add_row(e,t,a){$("#"+e+" tbody").append(base64_decode(a))}function ttable_replace_row_by_id(e,t,a){if($("#"+e+" tbody").find("#"+t).length>0){$("#"+e+" tbody").find("#"+t).replaceWith(base64_decode(a))}else{$("#"+e+" tbody").append(base64_decode(a))}}function tfieldlist_reset_fields(_,m){var h=parseInt(Math.random()*1e8);$(_).attr("id",h);var e=$(_).find("input,select");var v=[];$.each(e,function(e,t){var a=$(t).attr("id");var i=$(t).attr("widget");var n=$(t).attr("role");if(typeof a!=="undefined"){var r=a.split("_");r.pop();var o=r.join("_");var l=o+"_"+h;var s=$(t).parent();if(v.indexOf(l)>=0){var l=o+parseInt(Math.random()*100)+"_"+h}v.push(l);if(i=="tdate"||i=="ttime"||i=="tdatetime"){$(t).attr("id",l);if(m){$(t).val("")}if(typeof $(t).attr("exitaction")!=="undefined"){$(t).attr("exitaction",$(t).attr("exitaction").replace(a,l))}if(typeof $(t).attr("onblur")!=="undefined"){$(t).attr("onblur",$(t).attr("onblur").replace(a,l))}if(typeof $(t).attr("changection")!=="undefined"){$(t).attr("changection",$(t).attr("changection").replace(a,l))}if(typeof $(t).attr("onchange")!=="undefined"){$(t).attr("onchange",$(t).attr("onchange").replace(a,l))}grandparent=$(s).parent();t=$(t).detach();$(s).remove();grandparent.append(t);var c=i;if(i=="ttime"){var c="tdatetime"}var d=new RegExp(a,"g");tfieldlist_execute_scripts(grandparent,c,function(e){e=e.replace(d,l);return e})}else if(i=="tentry"){s=$(t).closest("td");$(t).attr("id",l);if(m){$(t).val("")}if(typeof $(t).attr("exitaction")!=="undefined"){$(t).attr("exitaction",$(t).attr("exitaction").replace(a,l))}if(typeof $(t).attr("onblur")!=="undefined"){$(t).attr("onblur",$(t).attr("onblur").replace(a,l))}var d=new RegExp(a,"g");tfieldlist_execute_scripts(s,"tentry",function(e){e=e.replace(d,l);return e})}else if(i=="tspinner"){$(t).attr("id",l);if(m){$(t).val("")}if(typeof $(t).attr("exitaction")!=="undefined"){$(t).attr("exitaction",$(t).attr("exitaction").replace(a,l))}if(typeof $(t).attr("onblur")!=="undefined"){$(t).attr("onblur",$(t).attr("onblur").replace(a,l))}grandparent=$(s).parent();t=$(t).detach();$(s).remove();grandparent.append(t);var d=new RegExp(a,"g");tfieldlist_execute_scripts(grandparent,"tspinner",function(e){e=e.replace(d,l);return e})}else if(i=="tcolor"){$(t).attr("id",l);if(m){$(t).val("")}if(typeof $(t).attr("exitaction")!=="undefined"){$(t).attr("exitaction",$(t).attr("exitaction").replace(a,l))}if(typeof $(t).attr("onblur")!=="undefined"){$(t).attr("onblur",$(t).attr("onblur").replace(a,l))}grandparent=$(s).parent();grandparent.find(".pickr").replaceWith('<span class="input-group-addon tcolor"><i class="tcolor-icon"></i></span>');var d=new RegExp(a,"g");tfieldlist_execute_scripts(grandparent,"tcolor",function(e){e=e.replace(d,l);return e})}else if(i=="thidden"){$(t).attr("id",l);if($(t).attr("uniqid")=="true"){$(t).val(parseInt(Math.random()*1e10))}else if(m){$(t).val("")}var d=new RegExp(a,"g");tfieldlist_execute_scripts(s,"thidden",function(e){e=e.replace(d,l);return e})}else if(i=="tdbmultisearch"||i=="tdbuniquesearch"){$(t).attr("id",l);$(t).removeData("select2-id").removeAttr("data-select2-id").find("option").removeAttr("data-select2-id");$(_).removeData("select2-id").removeAttr("data-select2-id");$(s).find(".select2-container").remove();var d=new RegExp(a,"g");tfieldlist_execute_scripts(s,"tdbmultisearch",function(e){e=e.replace(d,l);return e});if(m){setTimeout(function(){$(t).val("").trigger("change.select2")},10)}}else if(i=="tmultisearch"||i=="tuniquesearch"){$(t).attr("id",l);$(t).removeData("select2-id").removeAttr("data-select2-id").find("option").removeAttr("data-select2-id");$(_).removeData("select2-id").removeAttr("data-select2-id");$(s).find(".select2-container").remove();var d=new RegExp(a,"g");tfieldlist_execute_scripts(s,"tmultisearch",function(e){e=e.replace(d,l);return e});if(m){setTimeout(function(){$(t).val("").trigger("change.select2")},10)}}else if(i=="tcombo"){$(t).attr("id",l);if(m){$(t).val("")}if(n=="tcombosearch"){$(t).removeData("select2-id").removeAttr("data-select2-id").find("optgroup").removeAttr("data-select2-id");$(t).removeData("select2-id").removeAttr("data-select2-id").find("option").removeAttr("data-select2-id");$(t).removeData("select2-id").removeAttr("data-select2-id").find("optgroup").find("option").removeAttr("data-select2-id");$(_).removeData("select2-id").removeAttr("data-select2-id");$(s).find(".select2-container").remove()}if(typeof $(t).attr("changeaction")!=="undefined"){$(t).attr("changeaction",$(t).attr("changeaction").replace(a,l))}if(typeof $(t).attr("onchange")!=="undefined"){$(t).attr("onchange",$(t).attr("onchange").replace(a,l))}var d=new RegExp(a,"g");tfieldlist_execute_scripts(s,"tcombo",function(e){e=e.replace(d,l);return e})}else if(i=="tfile"){$(t).attr("id",l);if(m){$(t).val("")}var s=$(t).closest("td");var f=s.find(".div_file").attr("id");var u="div_file_"+h;s.find(".tfile_row_wrapper").remove();s.find(".file-response-icon").remove();s.find(".div_file").attr("id",u);$(t).css("padding-left","5px");if(typeof $(t).attr("changeaction")!=="undefined"){$(t).attr("changeaction",$(t).attr("changeaction").replace(a,l))}if(typeof $(t).attr("onchange")!=="undefined"){$(t).attr("onchange",$(t).attr("onchange").replace(a,l))}var d=new RegExp(a,"g");var p=new RegExp(f,"g");tfieldlist_execute_scripts(s,"tfile",function(e){e=e.replace(d,l);e=e.replace(p,u);return e})}}if(i=="tradiobutton"){$(t).parent().removeClass("active")}else if(i=="tcheckbutton"){$(t).parent().removeClass("active")}})}function tfieldlist_execute_scripts(e,i,n){var t=$(e).find("script");$.each(t,function(e,t){var a=$(t).text();a=n(a);if(a.trim().split("_")[0]==i){$(t).replaceWith("<script>"+a+"<\/script>")}})}function tfieldlist_clear(a){ttable_clone_previous_row($("[name="+a+"] tbody"));var i=$("[name="+a+"] tbody").find("tr").length-1;$("[name="+a+"] tbody").find("tr").each(function(e,t){if(e<i){ttable_remove_row(t)}});$("[name="+a+"] tfoot").find('input[type="text"]').each(function(e,t){tfieldlist_update_sum(a,$(t).attr("field_name"))})}function tfieldlist_add_rows(e,t,a){a=a?a:50;for(n=1;n<=t;n++){setTimeout(function(){ttable_clone_previous_row($("[name="+e+"] tbody"))},a*n)}}function tfieldlist_clear_rows(e,a,i){var t=$("[name="+e+"] tbody").find("tr").length;i=(i==0?t:i)+a;if(i>=t){ttable_clone_previous_row($("[name="+e+"] tbody").find("tr:last"));i=t}$("[name="+e+"] tbody").find("tr").each(function(e,t){if(e>=a&&e<i){$(t).remove()}})}function tfieldlist_get_last_row_data(e){var i={};i.index=$(e).closest("table").find("tbody tr:last").index();$(e).closest("table").find("tbody tr:last").find("[name]").each(function(e,t){var a=$(t).attr("name");a=a.replace("[]","");i[a]=$(t).val()});return i}function tfieldlist_get_row_data(e){var i={};i.index=$(e).closest("tr").index();i["_row_id"]=$(e).closest("tr").attr("id");$(e).closest("tr").find("[name]").each(function(e,t){var a=$(t).attr("name");a=a.replace("[]","");i[a]=$(t).val()});return i}function tfieldlist_column_sum(e){var i=0;$('[name="'+e+'[]"]').each(function(e,t){var a=tentry_get_data_by_id($(t).attr("id"));if(!isNaN(parseFloat(a))){i+=parseFloat(a)}});return i}function tfieldlist_update_sum(c,d,f){setTimeout(function(){var e=tfieldlist_column_sum(d);var t=$("[name^="+d+"]:first").data("nmask");var a=[];if(t){a=t.split("")}$("[name=grandtotal_"+d+"]").val(number_format(e,a[0]??2,a[1]??",",a[2]??"."));if(f&&typeof f==="function"){f()}var i=$("table[name="+c+"]").attr("total-update-action");if(typeof i!=="undefined"&&i.length>0){var n=$("table[name="+c+"]").closest("form");if(n){var r={};var o={};var l=$(n).serializeArray();$(l).each(function(e,t){var a=t.name;var a=a.replace("[]","");if(r[a]===undefined){r[a]=[]}r[a].push(t.value)});for(prop in r){if(r[prop].length>=1){for(var s=0;s<r[prop].length;s++){if(typeof o[s]=="undefined"){o[s]={}}o[s][prop]=r[prop][s]}}}r["list_data"]=o}__adianti_post_exec(i,r,null,"1",true)}},50)}function tfieldlist_enable_field(e){try{if($('table.tfieldlist[name="'+e+'"]').length>0){$('table.tfieldlist[name="'+e+'"]').parent().find(".tfieldlist-disable").remove()}}catch(e){console.log(e)}}function tfieldlist_disable_field(e){try{if($('table.tfieldlist[name="'+e+'"]').length>0){$('table.tfieldlist[name="'+e+'"]').parent().prepend('<div class="tfieldlist-disable"></div>')}}catch(e){console.log(e)}}function tdatagrid_inlineedit(a){$(function(){$(".inlineediting").editInPlace({callback:function(e,t){__adianti_load_page($(this).attr("action")+a+"&key="+$(this).attr("key")+"&"+$(this).attr("pkey")+"="+$(this).attr("key")+"&field="+$(this).attr("field")+"&value="+encodeURIComponent(t));return t},show_buttons:false,text_size:20,params:column=name})})}function tdatagrid_add_serialized_row(e,t){$("#"+e+" > tbody:last-child").append(t)}function tdatagrid_enable_groups(){$("[id^=tdatagrid_] tr[level]").not("[x=1]").css("cursor","pointer").attr("x","1").click(function(){if(!$(this).data("child-visible")){$(this).data("child-visible",false)}$(this).data("child-visible",!$(this).data("child-visible"));if($(this).data("child-visible")){$(this).siblings('[childof="'+$(this).attr("level")+'"]').hide("fast")}else{$(this).siblings('[childof="'+$(this).attr("level")+'"]').show("fast")}})}function tdatagrid_update_total(a){var s=a.substring(1);var e=document.querySelector(a);var t=new MutationObserver(function(e){e.forEach(function(e){if(e.target.tagName=="TBODY"){var t=$(a).find("[data-total-function=sum]");t.each(function(e,t){var a=0;var i=$(t).data("column-name");var n=$(t).data("total-mask");var r=n.split(":");if(r.length>0){var o=r[0];var l=r[1]}else{var o="";var l=n.substring(1)}$('[name="'+s+"_"+i+'[]"]').each(function(e,t){a+=parseFloat($(t).val())});$(t).html(o+" "+number_format(a,l.substring(0,1),l.substring(1,2),l.substring(2,3)));$(t).data("value",a);$(t).attr("data-value",a)})}})});var i={attributes:true,childList:true,characterData:true,subtree:true,attributeOldValue:true,characterDataOldValue:true};t.observe(e,i)}function tdatagrid_mutation_action(s,c){var d=s.substring(1);var e=document.querySelector(s);var t=new MutationObserver(function(e){var o={};var l={};e.forEach(function(e){if(e.target.tagName=="TBODY"){var t=$(s).find("[data-hidden-field=true]");t.each(function(e,t){var a=$(t).attr("name").replace(d+"_","");var a=a.replace("[]","");if(a.substring(0,1)!=="="){if(typeof o[a]=="undefined"){o[a]=[]}o[a].push($(t).val())}});for(prop in o){for(var a=0;a<o[prop].length;a++){if(typeof l[a]=="undefined"){l[a]={}}l[a][prop]=o[prop][a]}}var i={};var n=$(s).closest("form");if(n){var r=$(n).serializeArray();$(r).each(function(e,t){var a=t.name.replace("[]","");i[a]=t.value})}i["list_data"]=l;__adianti_post_exec(c,i,null,"1",true)}})});var a={attributes:true,childList:true,characterData:true,subtree:true,attributeOldValue:true,characterDataOldValue:true};t.observe(e,a)}function tbutton_enable_field(e,t){setTimeout(function(){$("button[name="+t+"]").removeAttr("disabled");$("button[name=btn_"+t+"]").removeAttr("disabled");$("#tbutton_"+t).removeAttr("disabled")},1)}function tbutton_disable_field(e,t){setTimeout(function(){$("button[name="+t+"]").attr("disabled",true);$("button[name=btn_"+t+"]").attr("disabled",true);$("#tbutton_"+t).attr("disabled",true)},1)}function tcheckgroup_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").attr("onclick",null);$("form[name="+e+"] [checkgroup="+t+"]").css("pointer-events","auto");$("form[name="+e+"] [checkgroup="+t+"]").closest(".toggle-wrapper").removeClass("tfield_block_events")},1)}function tcheckgroup_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").attr("onclick","return false");$("form[name="+e+"] [checkgroup="+t+"]").css("pointer-events","none");$("form[name="+e+"] [checkgroup="+t+"]").closest(".toggle-wrapper").addClass("tfield_block_events")},1)}function tcheckgroup_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [checkgroup="+t+"]").prop("checked",false)},1)}function tcheckgroup_reload(e,t,a){$("form[name="+e+"] [tcheckgroup="+t+"]").replaceWith(a)}function tcolor_enable_field(e,t){var a=tfield_get_selector(e,t);try{setTimeout(function(){$(a).trigger("enable");$(a).removeClass("tfield_disabled");$(a).css("pointer-events","auto")},1)}catch(e){console.log(e)}setTimeout(function(){$(a).next(".pickr").show()},1)}function tcolor_disable_field(e,t){var a=tfield_get_selector(e,t);try{setTimeout(function(){$(a).trigger("disable");$(a).addClass("tfield_disabled");$(a).css("pointer-events","none")},1)}catch(e){console.log(e)}setTimeout(function(){$(a).next(".pickr").hide()},1)}function tcolor_start(e,t,a,n,i){var r={pt:{clear:"Limpar",save:"Salvar"},es:{clear:"Limpiar",save:"Guardar"},en:{clear:"Clear",save:"Save"}};var o=$(`#${e}`);i.el=`#${e}+.tcolor`;i.theme=a;i.default=o.val()?o.val():null;i.i18n={"btn:clear":r[Adianti.language]["clear"],"btn:save":r[Adianti.language]["save"]};var l=Pickr.create(i);$(`#${e}`).on("focusin",function(){l.show()});$(`#${e}`).data("picker",l);o.on("disable",function(){l.disable()});o.on("enable",function(){l.enable()});l.on("save",function(e,t){const a=o.val();const i=e?.toHEXA().toString();o.val(i);t.hide();if(a!=i){if(typeof n!="undefined"){setTimeout(function(){n(i)},100)}}});l.on("swatchselect",function(e,t){t.applyColor()});o.on("change",function(){var e=this.value.indexOf("#")==-1?"#":"";if(this.value){l.setColor(e+this.value,false)}else{l.setColor(null)}})}function ticon_enable_field(e,t){try{setTimeout(function(){$("form[name="+e+'] div[name="block_'+t+'"]').remove()},1)}catch(e){console.log(e)}}function ticon_disable_field(e,t){try{input=$("form[name="+e+"] [name="+t+"]").closest(".input-group");setTimeout(function(){$("form[name="+e+'] div[name="block_'+t+'"]').remove()},19);setTimeout(function(){input.prepend('<div name="block_'+t+'" style="position:absolute; width:'+input.width()+"px; height:"+input.height()+'px; background: #c0c0c0; opacity:0.5;"></div>')},20)}catch(e){console.log(e)}}function ticon_start(e,t){if(t){$("#"+e).iconpicker().on("iconpickerUpdated",function(e){t($(this).val())})}else{$("#"+e).iconpicker()}}function tcombo_enable_field(e,t){let a=tfield_get_selector(e,t);try{if($(a).attr("role")=="tcombosearch"){tmultisearch_enable_field(e,t)}else{$(a).attr("onclick",null);$(a).css("pointer-events","auto");$(a).removeClass("tcombo_disabled")}}catch(e){console.log(e)}}function tcombo_disable_field(e,t){let a=tfield_get_selector(e,t);try{if($(a).attr("role")=="tcombosearch"){setTimeout(function(){tmultisearch_disable_field(e,t)})}else{$(a).attr("onclick","return false");$(a).attr("tabindex","-1");$(a).css("pointer-events","none");$(a).addClass("tcombo_disabled")}}catch(e){console.log(e)}}function tcombo_add_option(e,t,a,i){var a=a.replace(/"/g,"");let n=tfield_get_selector(e,t);var r=$(n).find("optgroup");if(r.length>0){$('<option value="'+a+'">'+i+"</option>").appendTo(r.last())}else{$('<option value="'+a+'">'+i+"</option>").appendTo(n)}}function tcombo_create_opt_group(e,t,a){let i=tfield_get_selector(e,t);$('<optgroup label="'+a+'"></optgroup>').appendTo(i)}function tcombo_clear(e,t,a){let i=tfield_get_selector(e,t);if(typeof a=="undefined"){a=true}var t=$(i);if(t.attr("role")=="tcombosearch"){if(t.find("option:not(:disabled)").length>0){t.val("").empty().trigger("change.select2")}}else{t.val(false);t.html("")}if(a){if(t.attr("changeaction")){tform_events_hang_exec(t.attr("changeaction"))}}}function tcombo_enable_search(t,e){$(t).removeAttr("onchange");var a={allowClear:true,placeholder:e,templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}}};$(t).select2(a).on("change",function(e){new Function($(t).attr("changeaction"))()});$(t).data("select2-options",a);$(t).addClass("byselect2")}function tdate_enable_field(e,t){let a=tfield_get_selector(e,t);try{$(a).removeClass("tfield_disabled");$(a).css("pointer-events","auto");$(a).removeAttr("tabindex");$(a).attr("readonly",false)}catch(e){console.log(e)}setTimeout(function(){$(a).next().show()},1)}function tdate_disable_field(e,t){let a=tfield_get_selector(e,t);try{$(a).addClass("tfield_disabled");$(a).css("pointer-events","none");$(a).attr("tabindex","-1");$(a).attr("readonly",true)}catch(e){console.log(e)}setTimeout(function(){$(a).next().hide()},1)}function tdate_set_value(e,t){$(e).val(t);$(e).closest(".tdate-group").datepicker("update")}function tdate_start(t,e,a,i,n){$(t).wrap('<div class="tdate-group date">');$(t).after('<span class="btn btn-default tdate-group-addon"><i class="far fa-calendar"></i></span>');var r={format:e,todayBtn:"linked",language:a,calendarWeeks:false,autoclose:true,todayHighlight:true,orientation:"bottom auto"};n=Object.assign(r,JSON.parse(n));$(t).closest(".tdate-group").datepicker(n).on("changeDate",function(e){if($(t).attr("exitaction")){new Function($(t).attr("exitaction"))()}}).on("show",function(){$(".datepicker").on("click",function(e){e.stopPropagation()})});if(i!=="undefined"){$(t).closest(".tdate-group").width(i)}}function tdatetime_start(t,e,a,i,n){$(t).wrap('<div class="tdate-group tdatetimepicker input-append date">');$(t).after('<span class="add-on btn btn-default tdate-group-addon"><i class="far fa-clock icon-th"></i></span>');atributes={autoclose:true,todayBtn:true,todayHighlight:true,format:e,language:a};n=Object.assign(atributes,JSON.parse(n));$(t).closest(".tdate-group").datetimepicker(n).on("change.dp",function(e){if($(t).attr("exitaction")){new Function($(t).attr("exitaction"))()}}).on("show",function(){$(".datepicker").on("click",function(e){e.stopPropagation()})});if(i!=="undefined"){$(t).closest(".tdate-group").width(i)}}function tdbentry_start(e,t,a){$('input[name="'+e+'"]').autocomplete({serviceUrl:t,minChars:a})}function tentry_new_mask(t,a){$(document).ready(function(){a=a.replace(/9/g,"0");var e=$("#"+t).attr("maxlength")>0?$("#"+t).attr("maxlength"):250;if(a=="A!"){a="A".repeat(e)}else if(a=="S!"){a="S".repeat(e)}else if(a=="0!"){a="0".repeat(e)}$("#"+t).mask(a)})}function tentry_mask(e,t,a){var i,n,r,o,l,s;i=e.value;if(typeof i=="undefined"){return true}if($(e).attr("forceupper")=="1"){i=i.toUpperCase()}if($(e).attr("forcelower")=="1"){i=i.toLowerCase()}if(document.all){keyCode=t.keyCode}else if(document.layers){keyCode=t.which}else{keyCode=t.which}if(keyCode==8||t.keyCode==9||t.keyCode==13){return true}o="";var c=0;if(a.charAt(1)=="!"){s=e.value.length+1}else{s=a.length}for(n=0;n<s-1;n++){maskChar=a.charAt(n);valueChar=i.charAt(c);if(n<=i.length){if((maskChar=="-"||maskChar=="_"||maskChar=="."||maskChar=="/"||maskChar=="\\"||maskChar==":"||maskChar=="|"||maskChar=="("||maskChar==")"||maskChar=="["||maskChar=="]"||maskChar=="{"||maskChar=="}")&maskChar!==valueChar){o+=maskChar}else{o+=valueChar;c++}}}e.value=o;l=e.value.length;if(a.charAt(1)=="!"){maskChar=a.charAt(0)}else{maskChar=a.charAt(l)}switch(maskChar){case"A":case"a":return keyCode>47&&keyCode<58||keyCode>64&&keyCode<91||keyCode>96&&keyCode<123;break;case"S":case"s":return keyCode>64&&keyCode<91||keyCode>96&&keyCode<123;break;case"9":return keyCode>47&&keyCode<58;break}return true}function tentry_upper(e){if(typeof e.value!=="undefined"){const t=e.selectionStart;const a=e.selectionEnd;e.value=e.value.toUpperCase();e.setSelectionRange(t,a)}}function tentry_lower(e){if(typeof e.value!=="undefined"){const t=e.selectionStart;const a=e.selectionEnd;e.value=e.value.toLowerCase();e.setSelectionRange(t,a)}}function tentry_autocomplete(e,t,a){var i;var n='input[name="'+e+'"]';if($("#"+e).length>0){var n="#"+e}var r={lookup:t,onSelect:function(){var e=$(this).data("val");var t=$(this).val();$(this).data("val",t);$(n).removeAttr("onblur");if(e!==t){if($(n).attr("exitaction")){string_callback=$(n).attr("exitaction");Function(string_callback)()}if($(n).attr("onKeyUp")){string_callback=$(n).attr("onKeyUp");Function(string_callback)()}}}};a=Object.assign(r,JSON.parse(a));$(n).autocomplete(a)}function tentry_autocomplete_by_name(e,t,a){objectId=$("[name="+e+"]").attr("id");tentry_autocomplete(objectId,t,a)}function tentry_numeric_mask(e,t,a,i,n,r){var o='input[name="'+e+'"]';if($("#"+e).length>0){var o="#"+e}$(o).maskMoney({prefix:"",suffix:"",affixesStay:true,thousands:i,decimal:a,precision:t,allowZero:true,allowNegative:r,formatOnBlur:n,reverse:n,bringCaretAtEndOnFocus:!n,selectAllOnFocus:false,allowEmpty:true})}function tentry_focus_by_id(e){if($("#"+e).length>0){$("#"+e).focus();var t=$("#"+e).val().length;$("#"+e)[0].setSelectionRange(t,t)}}function tentry_get_data_by_id(e){var t=$("#"+e).data("nmask");if(typeof t!=="undefined"){var a=t.substring(1,2);var i=t.substring(2,3);var n=$("#"+e).val();n=n.split(i).join("");n=n.split(a).join(".");return n}else{return $("#"+e).val()}}function tentry_exit_on_enter(t){$("#"+t).bind("keypress",function(e){if(e.keyCode==13){document.getElementById(t).blur()}})}function tentry_change_mask(e,t,a){var i=tfield_get_selector(e,t);$(document).ready(function(){a=a.replace(/9/g,"0");var e=$(i).attr("maxlength")>0?$(i).attr("maxlength"):250;if(a=="A!"){a="A".repeat(e)}else if(a=="S!"){a="S".repeat(e)}else if(a=="0!"){a="0".repeat(e)}$(i).mask(a)})}function tentry_toggle_visibility(e){$("#"+e+"-container").find("i").click(function(){var e=$(this);var t=$(this).closest("div").find("input");e.toggleClass("fa-eye-slash");e.toggleClass("fa-eye");if(t.attr("type")=="text"){t.attr("type","password")}else{t.attr("type","text")}})}function texpander_start(){$(".texpander-container").click(function(e){e.stopPropagation()})}function tfield_get_selector(e,t){if(typeof e!="undefined"&&e!=""){form_name_sel='form[name="'+e+'"] '}else{form_name_sel=""}var a='[name="'+t+'"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var a="#"+t}return form_name_sel+a}function tfield_enable_field(t,a){try{let e=tfield_get_selector(t,a);$(e).attr("readonly",false);$(e).removeClass("tfield_disabled")}catch(e){console.log(e)}}function tfield_disable_field(t,a){try{let e=tfield_get_selector(t,a);$(e).attr("readonly",true);$(e).addClass("tfield_disabled")}catch(e){console.log(e)}}function tfield_clear_field(t,a){try{let e=tfield_get_selector(t,a);$(e).val("")}catch(e){console.log(e)}}function tfield_transfer_value(e,t,a){if($(e).attr("type")=="checkbox"){var i=$(e).attr("value");var n=$(e).closest(a).find(t).val();if($(e).is(":checked")){n=n+i+","}else{n=n.replace(i+",","")}$(e).closest(a).find(t).val(n)}else{var n=$(e).val();$(e).closest(a).find(t).val(n)}}function FileUploader(e,t,a,i,n,r,o,l,s){this.field_name=$("#"+e).attr("receiver");this.input_id=e;this.limitSize=s;this.service_action=a;this.parent_container=$("#"+t);this.complete_action=i;this.error_action=n;this.file_handling=r;this.image_gallery=JSON.parse(o);this.popover=JSON.parse(l);this.obj_file=document.getElementById(this.input_id);var c=this;this.createStatusRow=function(){var e=c.parent_container.find("[widget=tfile]")[0];var t=$(e).css("width");var a=$("<div />",{class:"tfile_row_wrapper",style:"display:none"});var i=$("<div />",{class:"tfile_row_1"});var n=$("<div />",{class:"tfile_row_2"});var r=$("<div />",{class:"tfile_link_wrapper",style:"width: calc("+t+" - 25px)"});var o=$("<span />",{class:"tfile_del_icon fa fa-minus-circle gray",title:"Remover"});var l=$("<div />",{class:"progress-bar progress-bar-success",style:"width: 0%; height: 2px;"});var s=$("<input />",{type:"hidden",name:c.field_name,widget:"tfile"});if(c.image_gallery.enabled=="1"){$(r).css("width","unset");$(a).css("border","1px solid gray");$(a).css("border-radius","3px");$(a).css("margin","2px")}c.file_row_wrapper=a;c.file_input_hidden=s;c.file_progress_bar=l;c.file_link_wrapper=r;c.parent_container.children(".tfile_row_wrapper").remove();c.parent_container.append(a);a.append(i);a.append(n);i.append(s,r,o);n.append(l);$(o).click(function(){var e=c.getData();a.hide();c.parent_container.children("i").attr({class:"",title:""});c.parent_container.find("[widget=tfile]").css("padding-left","5px");e.delFile=e.fileName;if(e.delFile==e.newFile){e=""}c.setData(e)});return a};this.clear=function(){if(c.file_row_wrapper){c.file_row_wrapper.hide()}c.parent_container.children("i").attr({class:"",title:""});c.parent_container.find("[widget=tfile]").css("padding-left","5px");$(c.file_input_hidden).val("");$("#"+this.input_id).val("")};this.showFile=function(e){if(typeof e=="undefined"){var e=this.getData()}var t=e.fileName;if(t){var a=c.file_row_wrapper;var i=a.find(".tfile_link_wrapper");a.find(".progress-bar").css("width","100%");if($.inArray(t.split(".").pop().toLowerCase(),["png","jpg","jpeg","gif","svg","webp","ico","fav"])>-1){var n='<div class="popover" role="tooltip" style="z-index:100000;max-width:800px"><div class="arrow"></div><h3 class="popover-title popover-header"></h3><div class="popover-content popover-body"><div class="data-content"></div></div></div>';var r='<img style="max-width:460px" src="download.php?file={file_name}">';if(c.popover.content){r=atob(c.popover.content)}r=r.replace("{file_name}",t);if(c.image_gallery.enabled=="1"){var o=$("<a />",{href:"download.php?file="+t,target:"_blank"});var l=$("<img />",{src:"download.php?file="+t}).height(c.image_gallery.height).width(c.image_gallery.width);o.append(l);if(c.popover.enabled=="1"){o.popover({trigger:"hover",content:r,html:true,container:"body",template:n,title:c.popover.title||""})}}else{var o=$("<a />",{href:"download.php?file="+t,target:"_blank"});if(c.popover.enabled=="1"){o.popover({trigger:"hover",content:r,html:true,container:"body",template:n,title:c.popover.title||""})}}}else{var o=$("<a />",{href:"download.php?file="+t,target:"_blank"})}c.file_row_wrapper.show();if(c.image_gallery.enabled!="1"){o.append(t)}i.html(o)}};this.getData=function(){var e=decodeURIComponent(c.file_input_hidden.val());var t="";try{t=e?JSON.parse(e):{}}catch(e){t={}}return t};this.setData=function(e){c.clear();if(e){$(c.file_input_hidden).val(encodeURIComponent(JSON.stringify(e)))}};this.supportAjaxUploadWithProgress=function(){return this.supportFileAPI()&&this.supportAjaxUploadProgressEvents()&&this.supportFormData()};this.supportFileAPI=function(){var e=document.createElement("INPUT");e.type="file";return"files"in e};this.supportAjaxUploadProgressEvents=function(){var e=new XMLHttpRequest;return!!(e&&"upload"in e&&"onprogress"in e.upload)};this.supportFormData=function(){return!!window.FormData};this.initFileUpload=function(){if(c.file_handling){}var e=new FormData;var t=c.obj_file.files[0];e.append("fileName",t);if(c.limitSize){if(t.size>c.limitSize){c.onLoadStart();throw new Error(_t("large_file")+c.limitSize/1024/1024+"MBs")}}if(this.supportAjaxUploadWithProgress()){this.sendXHRequest(e,c.service_action)}};this.sendXHRequest=function(e,t){var a=new XMLHttpRequest;a.upload.addEventListener("loadstart",this.onLoadStart,false);a.upload.addEventListener("progress",this.onProgress,false);a.upload.addEventListener("load",this.onLoad,false);a.addEventListener("readystatechange",this.onReadyStateChange,false);a.open("POST",t,true);a.send(e)};this.onLoadStart=function(e){if(c.parent_container.children("i").length==0){c.parent_container.prepend($("<i>"))}if(c.file_handling){c.file_row_wrapper.show()}c.parent_container.find("[widget=tfile]").css("padding-left","20px");c.parent_container.children("i").attr({class:"fa fa-spinner fa-spin fa-fw blue file-response-icon",title:"..."})};this.onLoad=function(e){};this.onProgress=function(e){if(e.lengthComputable&&c.file_handling){var t=Math.round(e.loaded*100/e.total);c.file_progress_bar.css("width",t+"%").css("height",2);c.file_link_wrapper.html(t+"%")}};this.onReadyStateChange=function(t){var e=null;try{e=t.target.status}catch(e){return}if(e=="200"&&t.target.readyState=="4"&&t.target.responseText){try{var a=JSON.parse(t.target.responseText);if(a.type=="success"){if(c.file_handling){var i=c.getData();if(i.fileName){i.delFile=i.fileName}i.newFile="tmp/"+a.fileName;i.fileName="tmp/"+a.fileName;c.setData(i);c.showFile(i)}else{var n=$("#"+c.input_id).parent().children("input[type=hidden]");$(n).val(a.fileName)}c.showMessage("success",_t("success"));if(this.readyState==4&&typeof c.complete_action=="function"){c.complete_action()}}else{if(c.file_handling){c.file_row_wrapper.remove()}if(typeof c.error_action=="function"){c.error_action()}c.showMessage("error",a.msg)}}catch(e){if(typeof c.error_action=="function"){c.error_action()}if(c.file_handling){c.file_row_wrapper.remove()}if(typeof a=="undefined"){c.showMessage("error",t.target.responseText)}else{c.showMessage("error",e)}}}};this.showMessage=function(e,t){c.parent_container.children("i").removeAttr("data-original-title");if(e=="success"){c.parent_container.find("[widget=tfile]").css("padding-left","20px");c.parent_container.children("i").attr({class:"far fa-check-circle green file-response-icon",title:t})}else if(e=="error"){c.parent_container.find("[widget=tfile]").css("padding-left","20px");c.parent_container.children("i").attr({class:"fa fa-exclamation-circle red file-response-icon",title:t})}__adianti_process_tooltips()};this.setValue=function(e){this.clear();if(e){var t={fileName:e};if(e.indexOf("%7B%")>=0){t=JSON.parse(decodeURIComponent(e))}this.setData(t)}this.showFile()}}function tfile_start(a,i,n,r,o,l,s,c,d){$(function(){var t=new FileUploader(a,i,n,r,o,l,s,c,d);$("#"+a).change(function(){try{t.initFileUpload()}catch(e){t.clear();t.showMessage("error",e.message);if(typeof this.error_action=="function"){t.error_action()}}});if(l){var e=$("#"+a).parent().children("input[type=hidden]");t.createStatusRow();if($(e).val()){t.setData(JSON.parse(decodeURIComponent($(e).val())))}t.showFile();$(e).remove()}$('[name="'+t.field_name+'"]')[0].tfile=t})}function tfile_send_data(e,t){if(t){var a={fileName:t};var i=$("#"+e).data("instance");if(typeof i!="undefined"){i.setData(a);i.showFile()}}}function tfile_enable_field(e,t){try{$("form[name="+e+"] [name=file_"+t+"]").removeAttr("disabled");$("form[name="+e+"] [name=file_"+t+"]").removeClass("tfield_disabled").addClass("tfield")}catch(e){console.log(e)}}function tfile_disable_field(e,t){try{$("form[name="+e+"] [name=file_"+t+"]").attr("disabled",true);$("form[name="+e+"] [name=file_"+t+"]").removeClass("tfield").addClass("tfield_disabled")}catch(e){console.log(e)}}function tfile_clear_field(e,t){try{$("form[name="+e+"] [name="+t+"]").val("");$("form[name="+e+"] [name=file_"+t+"]").val("")}catch(e){console.log(e)}}function tfile_update_download_link(e){if($("#view_"+e).length){value=$("[name="+e+"]").val();$("#view_"+e).attr("href","download.php?file=tmp/"+value);$("#view_"+e).html("tmp/"+value)}}function MultiFileUploader(c,e,t,a,i,n,r,o,l){this.field_name=$("#"+c).attr("receiver");this.obj_file=e;this.limitSize=l;this.service_action=t;this.complete_action=i;this.file_handling=n;this.image_gallery=JSON.parse(r);this.popover=JSON.parse(o);this.parent_container=$("#"+a);this.instances=[];this.messages=[];var d=this;this.createStatusRow=function(){var e=d.parent_container.find("[widget=tmultifile]")[0];var t=$(e).css("width");var a=$("<div />",{class:"tfile_row_wrapper tfile_row_wrapper-"+c});var i=$("<div />",{class:"tfile_row_1"});var n=$("<div />",{class:"tfile_row_2"});var r=$("<div />",{class:"tfile_link_wrapper",style:"width: calc("+t+" - 25px)"});var o=$("<span />",{class:"tfile_del_icon fa fa-minus-circle gray",title:"Remover"});var l=$("<div />",{class:"progress-bar progress-bar-success",style:"width: 0%; height: 2px;"});var s=$("<input />",{type:"hidden",name:d.field_name+"[]"});if(d.image_gallery.enabled=="1"){$(r).css("width","unset");$(a).css("border","1px solid gray");$(a).css("border-radius","3px");$(a).css("margin","2px");$(a).css("display","inline-block")}d.file_row_wrapper=a;d.file_input_hidden=s;d.file_progress_bar=l;d.file_link_wrapper=r;d.parent_container.append(a);a.append(i);a.append(n);i.append(s,r,o);n.append(l);$(o).click(function(){var e=d.getData();a.hide();d.parent_container.children("i").attr({class:"",title:""});d.parent_container.find("[widget=tmultifile]").css("padding-left","5px");e.delFile=e.fileName;if(e.delFile==e.newFile){e="";d.setData(e);a.remove()}d.setData(e)});return a};this.createInputHidden=function(e){var t=$("<input />",{type:"hidden",name:d.field_name+"[]",widget:"thidden",value:e});d.parent_container.append(t);return t};this.showFile=function(e){if(typeof e=="undefined"){var e=this.getData()}var t=e.fileName;if(t){var a=d.file_row_wrapper;var i=a.find(".tfile_link_wrapper");a.find(".progress-bar").css("width","100%");if($.inArray(t.split(".").pop().toLowerCase(),["png","jpg","jpeg","gif","svg","webp","ico","fav"])>-1){var n='<div class="popover" role="tooltip" style="z-index:100000;max-width:800px"><div class="arrow"></div><h3 class="popover-title popover-header"></h3><div class="popover-content popover-body"><div class="data-content"></div></div></div>';var r='<img style="max-width:460px" src="download.php?file={file_name}">';if(d.popover.content){r=atob(d.popover.content)}r=r.replace("{file_name}",t);if(d.image_gallery.enabled=="1"){var o=$("<a />",{href:"download.php?file="+t,target:"_blank"});var l=$("<img />",{src:"download.php?file="+t}).height(d.image_gallery.height).width(d.image_gallery.width);o.append(l);if(d.popover.enabled=="1"){i.popover({trigger:"hover",content:r,html:true,container:"body",template:n,title:d.popover.title||""})}}else{var o=$("<a />",{href:"download.php?file="+t,target:"_blank"});if(d.popover.enabled=="1"){o.popover({trigger:"hover",content:r,html:true,container:"body",template:n,title:d.popover.title||""})}}}else{var o=$("<a />",{href:"download.php?file="+t,target:"_blank"})}if(d.image_gallery.enabled!="1"){o.append(t)}i.html(o)}};this.getData=function(){var e=decodeURIComponent(d.file_input_hidden.val());var t="";try{t=e?JSON.parse(e):{}}catch(e){t={}}return t};this.setData=function(e){if(e){$(d.file_input_hidden).val(encodeURIComponent(JSON.stringify(e)))}else{$(d.file_input_hidden).val("")}};this.supportAjaxUploadWithProgress=function(){return this.supportFileAPI()&&this.supportAjaxUploadProgressEvents()&&this.supportFormData()};this.supportFileAPI=function(){var e=document.createElement("INPUT");e.type="file";return"files"in e};this.supportAjaxUploadProgressEvents=function(){var e=new XMLHttpRequest;return!!(e&&"upload"in e&&"onprogress"in e.upload)};this.supportFormData=function(){return!!window.FormData};this.initFileUpload=function(){var e=new FormData;var t=d.obj_file;e.append("fileName",t);if(d.limitSize){this.onLoadStart();if(t.size>d.limitSize){throw new Error(_t("large_file")+d.limitSize/1024/1024+"MBs")}}this.createStatusRow();if(this.supportAjaxUploadWithProgress()){this.sendXHRequest(e,d.service_action)}};this.sendXHRequest=function(e,t){var a=new XMLHttpRequest;a.upload.addEventListener("loadstart",this.onLoadStart,false);a.upload.addEventListener("progress",this.onProgress,false);a.upload.addEventListener("load",this.onLoad,false);a.addEventListener("readystatechange",this.onReadyStateChange,false);a.open("POST",t,true);a.send(e)};this.onLoadStart=function(e){if(d.parent_container.children("i").length==0){d.parent_container.prepend($("<i>"))}d.parent_container.find("[widget=tmultifile]").css("padding-left","20px");d.parent_container.children("i").attr({class:"fa fa-spinner fa-spin fa-fw blue file-response-icon","data-original-title":"...",title:"..."})};this.onLoad=function(e){};this.onProgress=function(e){if(e.lengthComputable){var t=Math.round(e.loaded*100/e.total);d.file_progress_bar.css("width",t+"%").css("height",2);d.file_link_wrapper.html(t+"%")}};this.onReadyStateChange=function(t){var e=null;try{e=t.target.status}catch(e){return}if(e=="200"&&t.target.readyState=="4"&&t.target.responseText){try{var a=JSON.parse(t.target.responseText);if(a.type=="success"){if(d.file_handling){var i=d.getData();i.newFile="tmp/"+a.fileName;i.fileName="tmp/"+a.fileName;d.setData(i);d.showFile(i)}else{d.file_input_hidden.val(a.fileName);d.file_link_wrapper.html(a.fileName)}d.showMessage("success",_t("success"));if(this.readyState==4&&typeof d.complete_action=="function"){d.complete_action()}}else{d.file_row_wrapper.remove();d.showMessage("error",a.msg)}}catch(e){d.file_row_wrapper.remove();if(typeof a=="undefined"){d.showMessage("error",t.target.responseText)}else{d.showMessage("error",e)}}}};this.showMessage=function(e,t){d.parent_container.children("i").removeAttr("data-original-title");if(d.messages.length>0){if(e!="success"){d.messages.push(t)}else{d.messages.push("success")}var a=d.messages.filter(e=>e=="success").length>0?"fa fa-info-circle blue":"fa fa-exclamation-circle red";d.parent_container.find("[widget=tmultifile]").css("padding-left","20px");d.parent_container.children("i").attr({class:a+" file-response-icon",title:d.messages.filter(e=>e!="success").join(", ")})}else{if(e=="success"){d.parent_container.find("[widget=tmultifile]").css("padding-left","20px");d.parent_container.children("i").attr({class:"far fa-check-circle green file-response-icon",title:t})}else{d.messages.push(t);d.parent_container.find("[widget=tmultifile]").css("padding-left","20px");d.parent_container.children("i").attr({class:"fa fa-exclamation-circle red file-response-icon",title:t})}}__adianti_process_tooltips()};this.clear=function(){$(".tfile_row_wrapper-"+c).each(function(){$(this).find("input").each(function(){$(this).val("")});$(this).remove()});d.parent_container.children("i").attr({class:"",title:""});d.parent_container.find("[widget=tmultifile]").css("padding-left","5px");$('[name="file_'+this.field_name+'[]"]').val("");$(this.file_input_hidden).val("");$("#"+this.input_id).val("")};this.setValue=function(e){this.clear();if(!e){return}try{e=JSON.parse(e)}catch(e){}for(var t in e){var a=e[t];var i={idFile:t,fileName:a};if(a.indexOf("%7B%")>=0){i=JSON.parse(decodeURIComponent(a))}if(this.file_handling){this.createStatusRow();this.setData(i);this.showFile()}else{this.createInputHidden(a)}}};this.updateValueInfo=function(){var t=new DataTransfer;var a=d.instances.map(e=>e.obj_file);for(let e=0;e<a.length;e++){const i=a[e];t.items.add(i)}$("#"+c)[0].files=t.files};this.addInstance=function(e){this.instances.push(e)}}function tmultifile_start(i,n,r,o,l,s,c,d){var f=new MultiFileUploader(i,null,r,n,o,l,s,c,d);$(function(){$("#"+i).change(function(){f.messages=[];$.each($(this).prop("files"),function(e,t){var a=new MultiFileUploader(i,t,r,n,o,l,s,c,d);a.messages=f.messages;try{a.initFileUpload();f.addInstance(a)}catch(e){a.showMessage("error",a.obj_file.name+": "+e.message)}});f.updateValueInfo()});if(l){$("#"+i).parent().children("input[type=hidden]").each(function(e,t){var a=new MultiFileUploader(i,null,r,n,o,l,s,c,d);a.createStatusRow();if($(t).val()){a.setData(JSON.parse(decodeURIComponent($(t).val())))}a.showFile();$(t).remove();f.addInstance(a)})}$("#"+i)[0].tmultifile=f})}function tmultifile_enable_field(e,t){try{$("form[name="+e+"] [name='file_"+t+"[]']").removeAttr("disabled");$("form[name="+e+"] [name='file_"+t+"[]']").removeClass("tfield_disabled").addClass("tfield")}catch(e){console.log(e)}}function tmultifile_disable_field(e,t){try{$("form[name="+e+"] [name='file_"+t+"[]']").attr("disabled",true);$("form[name="+e+"] [name='file_"+t+"[]']").removeClass("tfield").addClass("tfield_disabled")}catch(e){console.log(e)}}function tmultifile_clear_field(e,t){try{$("form[name="+e+"] [name='"+t+"[]']").val("");$("form[name="+e+"] [name='file_"+t+"[]']").val("")}catch(e){console.log(e)}}function thtmleditor_enable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).next().find(".note-editable").attr("contenteditable",true);$(a).summernote("enable")},1)}function thtmleditor_disable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).next().find(".note-editable").attr("contenteditable",false);$(a).summernote("disable")},1)}function thtmleditor_clear_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).code("")},1)}function thtmleditor_get_length(e){e=e.replace(/(<p><br><\/p>)/gi," ");e=e.replace(/(<([^>]+)>)/gi,"");e=e.replace(/(&nbsp;)/gi," ");return e.length}function thtmleditor_insert_text(e,t,a){var i=tfield_get_selector(e,t);$(i).summernote("editor.saveRange");$(i).summernote("editor.restoreRange");$(i).summernote("editor.focus");$(i).summernote("editor.insertText",a)}function thtmleditor_insert_html(e,t,a){var i=tfield_get_selector(e,t);$(i).summernote("editor.saveRange");$(i).summernote("editor.restoreRange");$(i).summernote("editor.focus");$(i).summernote("editor.pasteHTML",base64_decode(a))}function thtmleditor_start(objectId,width,height,lang,options,buttons){var attributes={dialogsInBody:true,fontSizes:["8","9","10","11","12","14","18","24","36","48","64","82","150"],width:width,height:height,lang:lang,toolbar:[["undoredo",["undo","redo"]],["style",["style","bold","italic","underline","clear"]],["font",["fontname","fontsize","color"]],["para",["ul","ol","paragraph","height"]],["insert",["table","link","picture","hr"]],["view",["fullscreen","codeview","help"]]]};options=Object.assign(attributes,JSON.parse(options));if(buttons){const buttonsArray=JSON.parse(buttons);options.buttons={};const buttonsOptions=[];for(const button of buttonsArray){buttonsOptions.push(["mybutton_"+button.name,[button.name]]);options.buttons[button.name]=function(context){var ui=$.summernote.ui;var uibutton=ui.button({contents:base64_decode(button.icon)+(button.showLabel?base64_decode(button.title):""),tooltip:button.showLabel?null:base64_decode(button.title),click:function(){eval("((param) => ("+base64_decode(button.function)+")(param))(context)")}});return uibutton.render()}}options.toolbar.push(...buttonsOptions)}if(typeof options.completion!=="undefined"){if(typeof summernote_wordlist=="undefined"){summernote_wordlist={}}summernote_wordlist[objectId]=options.completion;options.hint={match:/\b(\w{1,})$/,search:function(t,e){e($.grep(summernote_wordlist[objectId],function(e){return e.indexOf(t)===0}))}}}if(options.airMode==true){setTimeout(function(){$("#"+objectId).parent().find(".note-editable").height(height+"px").css("overflow","auto")},1)}if(!!options.maxlength&&options.maxlength>0){options.callbacks={onKeydown:function(e){var t=thtmleditor_get_length($(e.currentTarget).html())+1;if(t>options.maxlength){var a=[8,33,34,35,36,37,38,39,40,45,46];if(!a.includes(e.keyCode))e.preventDefault()}},onKeyup:function(e){var t=thtmleditor_get_length($(e.currentTarget).html());$("#"+objectId).next(".note-editor").find(".counter").html(t+"/"+options.maxlength)},onPaste:function(e){e.preventDefault()}}}$("#"+objectId).summernote(options);$("#"+objectId).show();if(!!options.maxlength&&options.maxlength>0){var content=$("#"+objectId).parent().find(".note-editable").html();var length=thtmleditor_get_length(content);$("#"+objectId).next(".note-editor").append('<small style="position:absolute;bottom:10px;right:4px;" class="counter">'+length+"/"+options.maxlength+"</small>")}if(typeof $("#"+objectId).next(".note-editor")[0]!=="undefined"){var container=$("#"+objectId).next(".note-editor")[0];$(container).css("margin",$("#"+objectId).css("margin"))}}function thtml_editor_reload_completion(e,t){objectId=$("[name="+e+"]").attr("id");setTimeout(function(){summernote_wordlist[objectId]=t},1)}function tmenubar_start(){$(document).ready(function(){$(".dropdown-toggle").dropdown()})}function tmultisearch_start(e,t,a,i,n,r,o,l,s,c,d){var f={minimumInputLength:t,maximumSelectionLength:a,selectionTitleAttribute:d,allowClear:l,placeholder:i,multiple:n,minimumResultsForSearch:s,id:function(e){return e.id+"::"+e.text},templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}}};if(n!=="1"){delete f.maximumSelectionLength}$("#"+e).select2(f).on("select2:unselecting",function(){$(this).data("unselecting",true)}).on("select2:opening",function(e){if($(this).data("unselecting")){$(this).removeData("unselecting");e.preventDefault()}});if(typeof c!="undefined"){$("#"+e).on("change",function(e){c()})}if(parseInt(a)!==1){$("#"+e).parent().find(".select2-selection").height(o);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").height(o);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").css("overflow-y","auto")}$("#"+e).data("select2-options",f);$("#"+e).addClass("byselect2")}function tmultisearch_clear_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').val("").trigger("change");$("form[name="+e+'] [name="'+t+'"]').val("").trigger("change")}catch(e){console.log(e)}}function tmultisearch_enable_field(e,t){try{if($("form[name="+e+'] [name="'+t+'"]').length>0){$("form[name="+e+'] [name="'+t+'"]').next(".select2").find(".select2-disable").remove()}else{$("form[name="+e+'] [name="'+t+'[]"]').next(".select2").find(".select2-disable").remove()}}catch(e){console.log(e)}}function tmultisearch_disable_field(e,t,a){if(!a){a=""}try{if($("form[name="+e+'] [name="'+t+'"]').length>0){$("form[name="+e+'] [name="'+t+'"]').next(".select2").prepend('<div title="'+a+'" class="select2-disable"></div>')}else if($("[form="+e+'] [name="'+t+'"]').length>0){$("[form="+e+'] [name="'+t+'"]').next(".select2").prepend('<div title="'+a+'" class="select2-disable"></div>')}else{$("form[name="+e+'] [name="'+t+'[]"]').next(".select2").prepend('<div title="'+a+'" class="select2-disable"></div>')}}catch(e){console.log(e)}}$.fn.select2.amd.require(["select2/selection/search"],function(e){var t=e.prototype.searchRemoveChoice;e.prototype.searchRemoveChoice=function(){t.apply(this,arguments);this.$search.val("")}});$.fn.select2.amd.require(["select2/selection/single"],function(e){var a=e.prototype.update;e.prototype.update=function(e){a.apply(this,Array.prototype.slice.apply(arguments));var t=this.$selection.find(".select2-selection__rendered");t.removeAttr("title")}});$.fn.select2.amd.require(["select2/selection/multiple"],function(e){var i=e.prototype.update;e.prototype.update=function(e){i.apply(this,Array.prototype.slice.apply(arguments));var t=this.options.get("selectionTitleAttribute");if(t===false){var a=this.$selection.find(".select2-selection__rendered");a.find(".select2-selection__choice").removeAttr("title")}}});$(document).on("select2:open",()=>{let e=document.querySelectorAll(".select2-container--open .select2-search__field");e[e.length-1].focus()});function tmultientry_start(e,t,a,i,n){var r={tags:true,maximumSelectionLength:t,width:a,height:i,tokenSeparators:[",",";"]};if(typeof n!="undefined"){$("#"+e).on("change",function(e){n()})}var o=$("#"+e).select2(r);$("#"+e).parent().find(".select2-selection").height(i);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").height(i);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").css("overflow-y","auto")}function tdbuniquesearch_set_value(a,n,r,o){setTimeout(function(){if(n.substr(0,1)=="#"){var i=$(n)}else{var i=$("form[name="+a+"] [name="+n+"]")}var e=i.data("select2").options.options.hash;var t=i.data("select2").options.options.ajax.url+"&hash="+e+"&value="+r+"&onlyidsearch=1";$.ajax({url:t,dataType:"json"}).done(function(e){if(Array.isArray(e.result)){if(e.result.length>0){var t=e.result[0];var a=t.split("::");if(!i.find("option[value='"+a[0]+"']").length){i.append(new Option(a[1],a[0],true,true))}if(r==""){i.val("").trigger("change.select2")}else{var e=[];e.push(a[0]);i.val(e).trigger("change.select2")}if(typeof o=="function"){o()}}else{i.val("").trigger("change.select2")}}else{i.val("").trigger("change.select2")}}).fail(function(e,t,a){__adianti_error("Error",t+": "+"connection failed")})},1)}function tdbmultisearch_start(e,t,a,i,n,r,o,l,s,c,d){var f={minimumInputLength:t,maximumSelectionLength:a,allowClear:true,selectionTitleAttribute:d,placeholder:i,multiple:n,hash:s,id:function(e){return e.id+"::"+e.text},templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},ajax:{url:r,dataType:"json",delay:250,data:function(e,t){return{value:e.term,hash:s}},processResults:function(e,t){var a=[];$(e.result).each(function(e){var t=this.split("::");a.push({id:t[0],text:t[1]})});return{results:a}}}};if(n!=="1"){delete f.maximumSelectionLength}$("#"+e).select2(f).on("select2:unselecting",function(){$(this).data("unselecting",true)}).on("select2:opening",function(e){if($(this).data("unselecting")){$(this).removeData("unselecting");e.preventDefault()}});if(typeof c!="undefined"){$("#"+e).on("change",function(e){c()})}if(parseInt(a)!==1){$("#"+e).parent().find(".select2-selection").height(l);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").height(l);$("#"+e).parent().find(".select2-selection").find(".select2-selection__rendered").css("overflow-y","auto")}$("#"+e).data("select2-options",f);$("#"+e).addClass("byselect2")}function tdbmultisearch_set_value(a,i,r,o){setTimeout(function(){if(i.substr(0,1)=="#"){var n=$(i)}else{var n=$("form[name="+a+'] [name="'+i+'[]"]')}var e=n.data("select2").options.options.hash;var t=n.data("select2").options.options.ajax.url+"&hash="+e+"&value="+r+"&operator_idsearch=in&onlyidsearch=1&jsonvalue=1";$.ajax({url:t,dataType:"json"}).done(function(e){if(Array.isArray(e.result)){if(e.result.length>0){var t=[];for(const i of e.result){var a=i.split("::");t.push(a[0]);if(!n.find("option[value='"+a[0]+"']").length){n.append(new Option(a[1],a[0],true,true))}}if(r==""||r=="[]"){n.val("").trigger("change.select2")}else{n.val(t).trigger("change.select2")}if(typeof o=="function"){o()}}else{n.val("").trigger("change.select2")}}else{n.val("").trigger("change.select2")}}).fail(function(e,t,a){__adianti_error("Error",t+": "+"connection failed")})},1)}function tradiogroup_enable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).attr("onclick",null);$(a).css("pointer-events","auto");$(a).closest(".toggle-wrapper").removeClass("tfield_block_events")},1)}function tradiogroup_disable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).attr("onclick","return false");$(a).css("pointer-events","none");$(a).closest(".toggle-wrapper").addClass("tfield_block_events")},1)}function tradiogroup_clear_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).prop("checked",false)},1)}function tradiogroup_reload(e,t,a){$("form[name="+e+"] [tradiogroup="+t+"]").replaceWith(a)}function tseekbutton_enable_field(e,t){var a=tfield_get_selector(e,t);try{$(a).attr("disabled",false);$(a).removeClass("tfield_disabled").addClass("tseekentry")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [for="+t+"]").show()},1)}function tseekbutton_disable_field(e,t){var a=tfield_get_selector(e,t);try{$(a).attr("disabled",true);$(a).addClass("tfield_disabled").removeClass("tseekentry")}catch(e){console.log(e)}setTimeout(function(){$("form[name="+e+"] [for="+t+"]").hide()},1)}function tlabel_toggle_visibility(e){var t=$("#"+e);t.find("i").on("click",function(e){var t=$(this).prev();if(t.css("filter")==="none"){t.css("filter","blur(5px)");$(this).switchClass("fa-eye","fa-eye-slash")}else{t.css("filter","");$(this).switchClass("fa-eye-slash","fa-eye")}})}function tselect_enable_field(e,t){let a=tfield_get_selector(e,t+"[]");try{$(a).css("pointer-events","auto");$(a).css("user-select","auto");$(a).removeClass("tselect_disabled")}catch(e){console.log(e)}}function tselect_disable_field(e,t){let a=tfield_get_selector(e,t+"[]");try{$(a).attr("tabindex","-1");$(a).css("pointer-events","none");$(a).css("user-select","none");$(a).addClass("tselect_disabled")}catch(e){console.log(e)}}function tselect_clear_field(e,t){try{$("form[name="+e+'] [name="'+t+'[]"]').val("")}catch(e){console.log(e)}}function tselect_create_opt_group(e,t,a){if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var i='[name="'+t+'[]"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var i="#"+t}$('<optgroup label="'+a+'"></optgroup>').appendTo(e+i)}function tselect_add_option(e,t,a,i){var a=a.replace(/"/g,"");if(typeof e!="undefined"&&e!=""){e='form[name="'+e+'"] '}else{e=""}var n='select[name="'+t+'[]"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var n="#"+t}var r=$(e+n).find("optgroup");if(r.length>0){$('<option value="'+a+'">'+i+"</option>").appendTo(r.last())}else{$('<option value="'+a+'">'+i+"</option>").appendTo(e+n)}}function tselect_clear(e,t,a){if(typeof a=="undefined"){a=true}if(typeof e!="undefined"&&e!=""){var e='form[name="'+e+'"] '}else{var e=""}var i='[name="'+t+'[]"]';if(t.indexOf("[")==-1&&$("#"+t).length>0){var i="#"+t}var t=$(e+i);t.val(false);t.html("");if(a){if(t.attr("changeaction")){tform_events_hang_exec(t.attr("changeaction"))}}}function tselect_enable_search(t,e){$(t).removeAttr("onchange");$(t).select2({allowClear:true,multiple:true,placeholder:e,templateResult:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}},templateSelection:function(e){if(/<[a-z][\s\S]*>/i.test(e.text)){return $("<span>"+e.text+"</span>")}else{return e.text}}}).on("change",function(e){new Function($(t).attr("changeaction"))()})}function tslider_start(e,t,a,i,n){var t=$(e).val();$(e).wrap('<div class="tslidercontainer">');$(e).before('<div class="label">'+t+"</div>");$(e).on("input",function(){$(e).parent().find(".label").html(this.value)})}function tslider_enable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).css("pointer-events","auto");$(a).removeClass("tfield_disabled")},1)}function tslider_disable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).css("pointer-events","none");$(a).addClass("tfield_disabled")},1)}function tsortlist_start(e,t,a,n){$(e).sortable({connectWith:t,tolerance:"pointer",start:function(e,t){t.item.data("index",t.item.index());t.item.data("parenta",this.id)},receive:function(e,t){if(n>0){if($(this).children().length>n){$(t.sender).sortable("cancel");return}}var a=t.sender;var i=$(this);targetListName=this.getAttribute("itemname");document.getElementById(t.item.attr("id")+"_input").name=targetListName+"[]";if(t.item.css("display")!==i.attr("itemdisplay")){t.item.css("display",i.attr("itemdisplay"));detached=t.item.detach();$(i).append(detached)}},deactivate:a}).disableSelection()}function tsortlist_enable_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").sortable("enable")},1)}function tsortlist_disable_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").sortable("disable")},1)}function tsortlist_clear_field(e,t){setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").empty()},1)}function tsortlist_add_item_field(e,t,a,i,n){var r=document.createElement("li");var o=document.createElement("label");var l=document.createElement("input");o.setAttribute("style","width: 100%;");r.setAttribute("class","tsortlist_item btn btn-default ui-sortable-handle");r.setAttribute("style","display: block; height: auto;");r.setAttribute("id","tsortlist_"+t+"_item_"+n+"_li");o.innerHTML=i;l.setAttribute("id","tsortlist_"+t+"_item_"+n+"_li_input");l.setAttribute("name",t+"[]");l.setAttribute("value",a);l.setAttribute("type","hidden");r.appendChild(o);r.appendChild(l);setTimeout(function(){$("form[name="+e+"] [itemname="+t+"]").append(r)},1)}function tspinner_start(i,n,e){var t=e?"tstepper":"";$(i).wrap('<div class="input-group spinner '+t+'" data-trigger="spinner">');if(e){$(i).before('<a href="javascript:;" class="spin-minus" data-spin="down"><i class="fa fa-minus"></i></a>');$(i).after('<a href="javascript:;" class="spin-plus" data-spin="up"><i class="fa fa-plus"></i></a>')}else{$(i).after('<div class="input-group-addon"> <a href="javascript:;" class="spin-up" data-spin="up"><i class="fa fa-caret-up"></i></a> <a href="javascript:;" class="spin-down" data-spin="down"><i class="fa fa-caret-down"></i></a> </div>')}$(i).parent().spinner("changing",function(e,t,a){if($(i).attr("exitaction")){new Function($(i).attr("exitaction"))()}if(typeof n=="function"){n()}})}function tspinner_enable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).parent().css("pointer-events","auto");$(a).removeClass("tfield_disabled");$(a).removeAttr("readonly")},1)}function tspinner_disable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).parent().css("pointer-events","none");$(a).addClass("tfield_disabled");$(a).attr("readonly",true)},1)}function tfullcalendar_start(e,t,a,i,n,r,o,l,s,c,d,f,u,p,_,m){var h=0;var v=0;r.failure=function(e){__adianti_failure_request(e.xhr,e.xhr.status,e.xhr.statusText)};var g={headerToolbar:{left:"prev,next today",center:"title",right:"timeGridDay,timeGridWeek,dayGridMonth,listWeek"},locale:n,themeSystem:"bootstrap",hiddenDays:f,initialDate:i,initialView:a,allDaySlot:false,datesSet:function(e,t){setTimeout(function(){__adianti_process_popover()},100)},slotMinTime:c,slotMaxTime:d,slotLabelFormat:{hour12:false,hour:"2-digit",minute:"2-digit"},eventTimeFormat:{hour12:false,hour:"2-digit",minute:"2-digit"},editable:t,dayMaxEventRows:true,events:r,eventDurationEditable:p,eventStartEditable:u,eventDisplay:"block",eventSourceSuccess:function(e){setTimeout(__adianti_process_popover,1500);return e.eventArray},eventContent:function(e){return{html:e.event.title}},dateClick:function(e){if(o!==""&&h==0&&v==0){var t;if(e.allDay){t=e.dateStr}else{t=moment(e.date).format("YYYY-MM-DD HH:mm:ss")}__adianti_load_page(o+"&date="+t+"&view="+e.view.type)}},eventClick:function(e){if(l!==""&&h==0&&v==0){__adianti_load_page(l+"&id="+e.event.id+"&key="+e.event.id+"&view="+e.view.type)}},eventDragStart:function(){h=1},eventDragStop:function(){h=0},eventDrop:function(e){if(s!==""){__adianti_ajax_exec(s+"&id="+e.event.id+"&key="+e.event.id+"&start_time="+moment(e.event.start).format("YYYY-MM-DD HH:mm:ss")+"&end_time="+moment(e.event.end).format("YYYY-MM-DD HH:mm:ss"))}},eventResizeStart:function(){v=1},eventResizeStop:function(){v=0},eventResize:function(e){if(s!==""){__adianti_ajax_exec(s+"&id="+e.event.id+"&key="+e.event.id+"&start_time="+moment(e.event.start).format("YYYY-MM-DD HH:mm:ss")+"&end_time="+moment(e.event.end).format("YYYY-MM-DD HH:mm:ss"))}}};if(m){var b=($(document).innerHeight()??0)-($("html nav.navbar").innerHeight()??0)-($(".adianti_tabs_container").innerHeight()??0)-$("#adianti_div_content").innerHeight()-($("footer.main-footer").innerHeight()??0)-100;b=Math.max(b,500);g.expandRows=true;g.height=`${b}px`}_=Object.assign(g,JSON.parse(_));var w=$("#"+e)[0];var y=new FullCalendar.Calendar(w,_);y.render();var k=new ResizeObserver(function(){y.render()});k.observe(w);$("#"+e).data("fullcalendar",y)}function ticonview_contextmenu_start(a){$("#"+a).contextmenu(function(e){$(".dropdown-iconview").hide();var t=$("#"+a).next("ul");t.css("left",ticonview_mouseX(e,$("#"+a)));t.css("top",ticonview_mouseY(e,$("#"+a)));t.show();e.preventDefault()});return false}function ticonview_bind_click(){$(document).bind("click",function(e){$(".dropdown-iconview").hide()})}function ticonview_mouseX(e,t){var a=0;if($(t).closest(".ui-dialog").length>0){a=$(t).closest(".ui-dialog").offset().left}if(e.pageX){return e.pageX-a}else if(e.clientX){return e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)-a}else{return null}}function ticonview_mouseY(e,t){var a=0;if($(t).closest(".ui-dialog").length>0){a=$(t).closest(".ui-dialog").offset().top+50}if(e.pageY){return e.pageY-a}else if(e.clientY){return e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)-a}else{return null}}function ticonview_move_start(e,o,t,a){$("#"+e+" li"+t).draggable({zIndex:1e5,cursor:"pointer",start:function(e,t){$(this).css("opacity",.5);$(this).addClass("iconview-drag")},stop:function(e,t){$(this).css("opacity",1)},revert:function(e,t){$(this).data("uiDraggable").originalPosition={top:0,left:0};return!e}});$("ul.ticonview li"+a).droppable({accept:".iconview-drag",drop:function(e,t){var a=$(t.draggable).data();var i=$(this).data();var n={};for(var r in a){if(a.hasOwnProperty(r)&&(typeof a[r]=="string"||typeof a[r]=="number")){n["source_"+r]=a[r]}}for(var r in i){if(i.hasOwnProperty(r)&&(typeof i[r]=="string"||typeof i[r]=="number")){n["target_"+r]=i[r]}}__adianti_load_page(o+"&"+$.param(n))},over:function(e,t){$(this).addClass("ui-over").addClass($(this).attr("id"))},out:function(e,t){$(this).removeClass("ui-over")}})}function kanban_start_board(e,r){$("#"+e).sortable({revert:200,placeholder:"kanban-stage-placeholder",forcePlaceholderSize:true,helper:function(e,t){return $(t).clone().addClass("kanban-dragging")},start:function(e,t){t.item.show().addClass("kanban-ghost")},stop:function(e,t){t.item.show().removeClass("kanban-ghost")},update:function(e,t){var a=$(t.item).attr("stage_id");var i=[];$(".kanban-stage").each(function(){i.push($(this).attr("stage_id"))});var n=i.join("&order[]=");__adianti_load_page(r+"&key="+a+"&id="+a+"&stage_id="+a+"&order[]="+n)},cursor:"move",tolerance:"pointer",cancel:".kanban-stage-actions, .kanban-item, .kanban-shortcuts"})}function kanban_start_item(e,s){$("."+e).sortable({revert:200,placeholder:"kanban-item-placeholder",forcePlaceholderSize:true,connectWith:".kanban-item-sortable",helper:function(e,t){return $(t).clone().addClass("kanban-dragging")},start:function(e,t){t.item.show().addClass("kanban-ghost")},stop:function(e,t){t.item.show().removeClass("kanban-ghost")},update:function(e,t){if(s&&this===t.item.parent()[0]){var a=$(t.item).attr("item_id");var i=$(this).attr("stage_id");var n=[];$("[stage_id="+i+"] .kanban-item").each(function(){n.push($(this).attr("item_id"))});var r="";var o=n.indexOf(r);if(o!==-1)n.splice(o,1);var l=n.join("&order[]=");__adianti_load_page(s+"&key="+a+"&id="+a+"&stage_id="+i+"&order[]="+l)}},cursor:"move",tolerance:"pointer",cancel:".kanban-item-actions"})}function tchecklist_row_enable_check(i){$("table#"+i+" tbody tr td:not([href])").click(function(e){e.stopImmediatePropagation();e.stopPropagation();e.preventDefault();var t=$(this).parent().find("[type=checkbox]");var a=$(t).is(":checked");$(t).prop("checked",!a);if(!a){$(this).parent().addClass("selected")}else{$(this).parent().removeClass("selected")}tchecklist_fire_onselect($("table#"+i))});$("table#"+i+" tbody tr input[type=checkbox]").click(function(e){e.stopPropagation();var t=$(this).is(":checked");var a=$(this).closest("tr");if(t){$(a).addClass("selected")}else{$(a).removeClass("selected")}tchecklist_fire_onselect($("table#"+i))})}function tchecklist_fire_onselect(e){var t=e.attr("onselect");if(t){var i=e.attr("name");var a=e.find("tr.selected").find('input[type="checkbox"]');var n={};n[i]=[];a.each(function(e,t){var a=$(t).attr("name");a=a.replace("check_"+i+"_","");n[i].push(base64_decode(a))});__adianti_post_exec(t,n,null,undefined,"1")}}function tchecklist_toggle_select_all(i,e){$("table#"+e+" tbody tr:visible td input[type=checkbox]").each(function(e,t){var a=t.closest("tr");if(!i.checked&&t.checked){$(t).prop("checked",false);$(a).removeClass("selected")}else if(i.checked&&!t.checked){$(t).prop("checked",true);$(a).addClass("selected")}});tchecklist_fire_onselect($("table#"+e))}function tchecklist_select_all_by_name(e,t){var a=$('table[widget="tchecklist"][name="'+e+'"] input[role="check-all"]');var i=$('table[widget="tchecklist"][name="'+e+'"]').attr("id");$(a).prop("checked",true);$("table#"+i+" tbody tr:visible td input[type=checkbox]").each(function(e,t){var a=t.closest("tr");$(t).prop("checked",true);$(a).addClass("selected")});if(t){tchecklist_fire_onselect($("table#"+i))}}function tchecklist_select_none_by_name(e,t){var a=$('table[widget="tchecklist"][name="'+e+'"] input[role="check-all"]');var i=$('table[widget="tchecklist"][name="'+e+'"]').attr("id");$(a).prop("checked",false);$("table#"+i+" tbody tr:visible td input[type=checkbox]").each(function(e,t){var a=t.closest("tr");$(t).prop("checked",false);$(a).removeClass("selected")});if(t){tchecklist_fire_onselect($("table#"+i))}}function tchecklist_enable_field(e){try{if($('table.tchecklist[name="'+e+'"]').length>0){$('table.tchecklist[name="'+e+'"]').parent().find(".tchecklist-disable").remove()}}catch(e){console.log(e)}}function tchecklist_disable_field(e){try{if($('table.tchecklist[name="'+e+'"]').length>0){$('table.tchecklist[name="'+e+'"]').parent().prepend('<div class="tchecklist-disable"></div>')}}catch(e){console.log(e)}}var tbarcodeinputreader;var tbarcodeinputreader_receive;function tbarcodeinputreader_open_reader(t){var e=t+"_reader";var a=t+"_container";var i=$(window).width()*.9;var n=$(window).height()*.8;var r=document.createElement("div");var o=document.createElement("div");var l=document.createElement("video");r.title="Barcode";r.id=a;l.id=e;o.id=e+"-cameras";r.setAttribute("class","tbarcodeinputreader_container");l.setAttribute("class","tbarcodeinputreader_reader");o.setAttribute("class","tbarcodeinputreader-cameras");r.appendChild(l);r.appendChild(o);$("#adianti_div_content").append(r);tbarcodeinputreader_start(e,function(){tjquerydialog_start("#"+a,true,false,false,i,n,0,0,99999,[],function(){tbarcodeinputreader.closing=true;tbarcodeinputreader_stop()},true,"")},function(e){__adianti_block_ui();$("#"+t).val(e);tbarcodeinputreader_stop();if(typeof $("#"+t).attr("changeaction")!=="undefined"){Function($("#"+t).attr("changeaction"))()}__adianti_unblock_ui()})}function tbarcodeinputreader_start(a,i,e){tbarcodeinputreader=new ZXing.BrowserBarcodeReader;tbarcodeinputreader.closing=false;tbarcodeinputreader._stopContinuousDecode=false;tbarcodeinputreader_receive=e;tbarcodeinputreader.listVideoInputDevices().then(function(e){if(!e||e.length==0){return}i();if(e.length>1){trbarcodeinputreader_make_radio_camera(a,e)}var t=e[e.length-1].deviceId;tbarcodeinputreader_read(t,a)}).catch(function(e){__adianti_error("Error",e)})}function trbarcodeinputreader_make_radio_camera(e,t){for(var a=0;a<t.length;a++){var i=t[a];var n=document.createElement("input");var r=document.createElement("label");n.id=i.deviceId;n.type="radio";n.name=e+"-camera";n.setAttribute("onchange","tbarcodeinputreader_restart('"+i.deviceId+"','"+e+"');");r.for=i.deviceId;r.appendChild(n);r.appendChild(document.createTextNode(i.label));if(a==t.length-1){n.checked=true}$("#"+e+"-cameras").append(r)}}function tbarcodeinputreader_stop(){tbarcodeinputreader_close()}function tbarcodeinputreader_close(){tbarcodeinputreader.reset();$(".tbarcodeinputreader_container").closest(".ui-dialog").remove();$(".tbarcodeinputreader_container").remove()}function tbarcodeinputreader_restart(e,t){tbarcodeinputreader.closing=true;tbarcodeinputreader.reset();tbarcodeinputreader_read(e,t)}function tbarcodeinputreader_read(e,t){tbarcodeinputreader.decodeOnceFromVideoDevice(e,t).then(function(e){tbarcodeinputreader_receive(e)}).catch(function(e){if(tbarcodeinputreader&&tbarcodeinputreader.closing){return}tbarcodeinputreader_close();__adianti_error("Error",e)})}var tqrcodeinputreader;var tqrcodeinputreader_receive;function tqrcodeinputreader_open_reader(t){var e=t+"_reader";var a=t+"_container";var i=$(window).width()*.9;var n=$(window).height()*.8;var r=document.createElement("div");var o=document.createElement("div");var l=document.createElement("div");r.title="QRCode";r.id=a;l.id=e;o.id=e+"-cameras";r.setAttribute("class","tqrcodeinputreader_container");l.setAttribute("class","tqrcodeinputreader_reader");o.setAttribute("class","tqrcodeinputreader-cameras");r.appendChild(l);r.appendChild(o);$("#adianti_div_content").append(r);tqrcodeinputreader_start(e,function(){tjquerydialog_start("#"+a,true,false,false,i,n,0,0,99999,[],tqrcodeinputreader_stop,true,"")},function(e){__adianti_block_ui();$("#"+t).val(e);tqrcodeinputreader_stop();if(typeof $("#"+t).attr("changeaction")!=="undefined"){Function($("#"+t).attr("changeaction"))()}__adianti_unblock_ui()})}function tqrcodeinputreader_start(a,i,e){tqrcodeinputreader=new Html5Qrcode(a);tqrcodeinputreader_receive=e;Html5Qrcode.getCameras().then(function(e){if(!e||e.length==0){return}i();if(e.length>1){trqcodeinputreader_make_radio_camera(a,e)}var t=e[e.length-1].id;tqrcodeinputreader_read(t)}).catch(function(e){__adianti_error("Error",e)})}function trqcodeinputreader_make_radio_camera(e,t){for(var a=0;a<t.length;a++){var i=t[a];var n=document.createElement("input");var r=document.createElement("label");n.id=i.id;n.type="radio";n.name=e+"-camera";n.setAttribute("onchange","tqrcodeinputreader_restart('"+i.id+"');");r.for=i.id;r.appendChild(n);r.appendChild(document.createTextNode(i.label));if(a==t.length-1){n.checked=true}$("#"+e+"-cameras").append(r)}}function tqrcodeinputreader_stop(){if(!tqrcodeinputreader||!tqrcodeinputreader._isScanning){tqrcodeinputreader_close();return}tqrcodeinputreader.stop().then(function(){tqrcodeinputreader_close()}).catch(function(e){__adianti_error("Error",e)})}function tqrcodeinputreader_close(){$(".tqrcodeinputreader_container").closest(".ui-dialog").remove();$(".tqrcodeinputreader_container").remove();tqrcodeinputreader=null}function tqrcodeinputreader_restart(e){tqrcodeinputreader.stop().then(function(){tqrcodeinputreader_read(e)}).catch(function(e){__adianti_error("Error",e)})}function tqrcodeinputreader_read(e){tqrcodeinputreader.start(e,{qrbox:$("#"+tqrcodeinputreader._elementId).width()*.75},function(e){tqrcodeinputreader_receive(e)},function(e){}).catch(function(e){__adianti_error("Error",e)})}var TImageCropper=function(e,t,a,i,n,r,o,l,s,c){this.cropper;this.url;this.name=s;this.type=c;this.fileHandling=n;this.serviceAction=i;this.field=e;this.title=t;this.buttonLabel=a;this.config=l;this.base64=r;this.webcam=o;this.file_input_hidden=$("input[name="+e+"]");this.file=$("#tfile_timagecropper_"+e);this.image=$("#timagecropper_"+e);this.actions=$("#timagecropper_"+e+"+div.timagecropper_actions");this.placeholder=this.actions.parent().find(".image-placeholder");this.edit=this.actions.find("[action=edit]");this.remove=this.actions.find("[action=remove]");this.file.click(function(e){if(!o||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return}e.preventDefault();var a=document.createElement("div");a.id="webcam_"+s.replace(".","");a.title="WebCam";$(a).addClass("timagecropper_webcam");$("#adianti_div_content").append(a);var t=$(window).height()*.75;var i=t/3*4;Webcam.set({image_format:"png",width:i,height:t,dest_width:i,dest_height:t,constraints:{}});Webcam.off("error");Webcam.on("error",function(e){if(e.name=="FlashError"||e.name=="WebcamError"){__adianti_error("Error",e.message)}else{__adianti_error("Error","Could not access webcam: "+e.message)}});tjquerydialog_start("#"+a.id,true,true,false,i,t,0,0,2050,[{text:"Capturar",click:function(){Webcam.snap(function(e){var t=g(e);d(a.id);_(null,[t])})}}],function(){d(a.id)},true,"");setTimeout(function(){Webcam.attach("#"+a.id)},500)});var d=function(e){Webcam.reset();$("#"+e).remove()};this.dropzone=$("#timagecropper_container_"+e);this.dropzone.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault();e.stopPropagation()});this.dropzone.on("dragover dragenter",function(){$("#timagecropper_container_"+e).addClass("highlight")});this.dropzone.on("dragleave dragend drop",function(){$("#timagecropper_container_"+e).removeClass("highlight")});var f=this;var u=function(e){__adianti_block_ui();f.url=f.image[0].src;v();__adianti_unblock_ui();e.preventDefault()};var p=function(e){var t=$("#timagecropper_"+f.field)[0];if(f.fileHandling){var a=k();a.delFile=a.fileName;a.fileName="";a.newFile="";if(a.delFile==a.newFile){a=""}y(a);t.src=" "}else{var t=$("#timagecropper_"+f.field)[0];f.url=null;t.src=" ";y("")}f.actions.hide();f.placeholder.show();e.preventDefault()};var _=function(e,t){__adianti_block_ui();var a=t||e.target.files||e.originalEvent.dataTransfer.files;if(a&&a.length>0){var i=a[0];f.name=i.name;f.type=i.type;m(i);__adianti_unblock_ui()}else{__adianti_unblock_ui()}};var m=function(e){if(URL){f.url=URL.createObjectURL(e);v()}else if(FileReader){reader=new FileReader;reader.onload=function(e){f.url=reader.result;v()};reader.readAsDataURL(e)}};var h=function(){var e=$("#timgagecropper_image_"+f.field)[0];var t={viewMode:0,highlight:true,rotatable:true,responsive:true,restore:true,modal:true,guides:true};if(f.config.aspectRatio){t.aspectRatio=f.config.aspectRatio}f.cropper=new Cropper(e,t)};var v=function(){__adianti_block_ui();var e=document.createElement("div");var t=document.createElement("div");var a=document.createElement("div");var i=document.createElement("div");var n=document.createElement("img");var r=$(window).width()*.95;var o=$(window).height()*.9;n.src=f.url;n.id="timgagecropper_image_"+f.field;e.title=f.title;e.id="container_timgagecropper_image_"+f.field;a.appendChild(i);t.appendChild(n);t.appendChild(a);e.appendChild(t);if($(window).width()<540){var l=r-30;var s=o-200}else{var l=r-100;var s=o-130}t.setAttribute("style","width: "+l+"px; height: "+s+"px");n.setAttribute("class","img_timagecrroper");t.setAttribute("class","container_timagecrroper");a.setAttribute("class","actions_timagecrroper");a.setAttribute("class","actions_timagecrroper");if(f.config.enableButtonDrag){i.appendChild(D())}if(f.config.enableButtonScale){i.appendChild(C())}if(f.config.enableButtonZoom){i.appendChild(L())}if(f.config.enableButtonRotate){i.appendChild(q())}if(f.config.enableButtonRotate){i.appendChild(x())}$("#adianti_div_content").append(e);tjquerydialog_start("#"+e.id,true,false,false,r,o,0,0,2050,[{text:f.buttonLabel,click:b}],null,true,"");h();__adianti_unblock_ui()};var g=function(e){var t=e.split(",");var a=atob(t[1]);var i=a.length;var n=new Uint8Array(i);while(i--){n[i]=a.charCodeAt(i)}var r=f.name?f.name:"image"+Math.floor(Math.random()*1e6+1)+".png";var o=f.type?f.type:"image/png";return new File([n],r,{type:o})};var b=function(){__adianti_block_ui();var e=f.cropper.getCroppedCanvas({width:f.config.cropWidth,heigth:f.config.cropHeight});var t=e.toDataURL(f.type);$("#timagecropper_"+f.field).attr("src",t);$("#timagecropper_"+f.field).show();f.actions.show();f.placeholder.hide();if(f.base64){f.file_input_hidden.val(t)}else{try{var a=g(t);var i=new FormData;i.append("fileName",a);var n=new XMLHttpRequest;n.open("POST",f.serviceAction,true);n.addEventListener("readystatechange",w,false);n.send(i);if(f.fileHandling){var r=k();if(r.fileName&&r.fileName!=r.newFile){r.delFile=r.fileName}r.newFile="tmp/"+f.name;r.fileName="tmp/"+f.name;y(r)}else{f.file_input_hidden.val(f.name)}}catch(e){__adianti_error("Error",e)}}$("#container_timgagecropper_image_"+f.field).closest(".ui-dialog").remove();$("#container_timgagecropper_image_"+f.field).remove();f.cropper.destroy();__adianti_unblock_ui()};var w=function(e){var t=null;try{t=e.target.status}catch(e){return}if(t=="200"&&e.target.readyState=="4"&&e.target.responseText){try{var a=JSON.parse(e.target.responseText);if(a.type=="error"){__adianti_error("Error",a.msg)}}catch(e){__adianti_error("Error",e)}}};var y=function(e){if(e){$(f.file_input_hidden).val(encodeURIComponent(JSON.stringify(e)))}else{$(f.file_input_hidden).val("")}};f.sendData=y;var k=function(){var e=decodeURIComponent(f.file_input_hidden.val());var t="";try{t=e?JSON.parse(e):{}}catch(e){t={}}return t};var x=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-sync-alt");t.setAttribute("title",f.config.labels.reset);t.addEventListener("click",function(){f.cropper.reset()});t.addEventListener("touchstart",function(){f.cropper.reset()});t.appendChild(e);return t};var C=function(){var e=A();var t=E();var a=document.createElement("div");a.appendChild(e);a.appendChild(t);return a};var A=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-arrows-alt-h");t.setAttribute("title",f.config.labels.scalex);t.setAttribute("data-option","-1");t.addEventListener("click",function(){S(this)});t.addEventListener("touchstart",function(){S(this)});t.appendChild(e);return t};var E=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-arrows-alt-v");t.setAttribute("title",f.config.labels.scaley);t.setAttribute("data-option","-1");t.addEventListener("click",function(){T(this)});t.addEventListener("touchstart",function(){T(this)});t.appendChild(e);return t};var S=function(e){var t=e.getAttribute("data-option");f.cropper.scaleX(t);e.setAttribute("data-option",t*-1)};var T=function(e){var t=e.getAttribute("data-option");f.cropper.scaleY(t);e.setAttribute("data-option",t*-1)};var D=function(){var e=N();var t=R();var a=document.createElement("div");a.appendChild(e);a.appendChild(t);return a};var N=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-arrows-alt");t.setAttribute("title",f.config.labels.move);t.addEventListener("click",function(){f.cropper.setDragMode("move")});t.addEventListener("touchstart",function(){f.cropper.setDragMode("move")});t.appendChild(e);return t};var R=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-crop-alt");t.setAttribute("title",f.config.labels.crop);t.addEventListener("click",function(){f.cropper.setDragMode("crop")});t.addEventListener("touchstart",function(){f.cropper.setDragMode("crop")});t.appendChild(e);return t};var L=function(){var e=O();var t=F();var a=document.createElement("div");a.appendChild(e);a.appendChild(t);return a};var O=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-search-plus");t.setAttribute("title",f.config.labels.zoomin);t.addEventListener("click",function(){f.cropper.zoom(.1)});t.addEventListener("touchstart",function(){f.cropper.zoom(.1)});t.appendChild(e);return t};var F=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-search-minus");t.setAttribute("title",f.config.labels.zoomout);t.addEventListener("click",function(){f.cropper.zoom(-.1)});t.addEventListener("touchstart",function(){f.cropper.zoom(-.1)});t.appendChild(e);return t};var q=function(){var e=j();var t=I();var a=document.createElement("div");a.appendChild(t);a.appendChild(e);return a};var j=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-redo-alt");t.setAttribute("title",f.config.labels.rotateright);t.addEventListener("click",function(){f.cropper.rotate(45)});t.addEventListener("touchstart",function(){f.cropper.rotate(45)});t.appendChild(e);return t};var I=function(){var e=document.createElement("i");var t=document.createElement("button");t.setAttribute("class","btn btn-default");e.setAttribute("class","fa fa-undo-alt");t.setAttribute("title",f.config.labels.rotateleft);t.setAttribute("data-option","-45");t.addEventListener("click",function(){f.cropper.rotate(-45)});t.addEventListener("touchstart",function(){f.cropper.rotate(-45)});t.appendChild(e);return t};this.clear=function(){this.actions.hide();this.image.hide();this.file_input_hidden.val("")};this.setValue=function(e){this.clear();if(e){if(this.fileHandling){var t={fileName:e};if(e.indexOf("%7B%")>=0){t=JSON.parse(decodeURIComponent(e))}this.image.attr("src","download.php?file="+t.fileName);this.image.show();this.actions.show();this.sendData(t)}else{this.file_input_hidden.val(e)}}};this.file.change(_);this.dropzone.on("drop",_);this.edit.click(u);this.remove.click(p)};function timagecropper_start(e,t,a,i,n,r,o,l,s,c){var d=new TImageCropper(e,t,a,i,n,r,o,l,s,c);$("input[name="+e+"]")[0].timagecropper=d}function tarrowstep_disable_field(e){$(`.arrow_steps_${e}`).addClass("disabled")}function tarrowstep_enable_field(e){$(`.arrow_steps_${e}`).removeClass("disabled")}function tarrowstep_clear(e){$(`.arrow_steps_${e} .step`).removeClass("current");$(`input[name='${e}']`).val("")}function tarrowstep_set_current(e,a){$(`.arrow_steps_${e} .step`).removeClass("current");$(`input[name='${e}']`).val(a);var i=true;$(`.arrow_steps_${e} .step`).each(function(e,t){if(i){$(t).addClass("current")}if($(t).data("key")==a){i=false}})}function tarrowstep_start(e){$(`.arrow_steps_${e} .step`).on("click",function(){tarrowstep_set_current(e,$(this).data("key"))});$(`.arrow_steps_${e} .step`).on("mouseenter",function(){var a=$(this).data("key");var i=true;$(`.arrow_steps_${e} .step`).each(function(e,t){if(i){$(t).addClass("preview-current")}if($(t).data("key")==a){i=false}})});$(`.arrow_steps_${e} .step`).on("mouseleave",function(){$(`.arrow_steps_${e} .step`).removeClass("preview-current")})}function tgantt_start(e,t,a,i,n){tgantt_set_height(e);$(e).data("pixelStep",i);$(e).data("minuteStep",a);$(e).data("lastHour",0);if(n){tgantt_set_update_action(e,n)}if(t){tgantt_set_day_action(e,t)}}function tgantt_set_day_action(e,t){$(e+" .tgantt-event").on("click",function(e){e.stopPropagation();e.preventDefault();__adianti_load_page($(this).attr("href"))});$(e+" .tgantt-cell").on("click",function(){var e=$(this).closest("tr").data();__adianti_load_page(t+"&start_time="+$(this).data("date")+"&group_id="+e["id"]+"&group_title="+e["title"])})}function tgantt_format_date(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")}function tgantt_set_update_action(_,m){var h=$(_).data("pixelStep");$(_+" .tgantt-event").draggable({addClasses:false,delay:50,axis:"x",grid:[h,100],drag:function(e,t){tgantt_update_data_title(_,t)},stop:function(e,t){e.stopPropagation();if(t.position.left<0){var a=t.helper.width();var i=Math.abs(t.position.left);var n=parseInt(t.helper.css("margin-left"));if(a+(n-i)<=h){var r=(n+a)*-1+parseFloat(h);t.helper.css("left",r+"px");t.position.left=r}}else{var o=t.helper.parent().parent().width();var i=Math.abs(t.position.left);var a=t.helper.width();var n=parseInt(t.helper.css("margin-left"));if(i+n>=o){var r=o-n-parseFloat(h);t.helper.css("left",r+"px");t.position.left=r}}var l=tgantt_get_time_drag(_,t);var s=JSON.parse(base64_decode(t.helper.attr("data")));var c=new Date(s.start_time);c.setTime(c.getTime()+l*60*60*1e3);var d=new Date(s.end_time);d.setTime(d.getTime()+l*60*60*1e3);var f=s.id;var u=tgantt_format_date(c);var p=tgantt_format_date(d);s.start_time=u;s.end_time=p;t.helper.attr("data",base64_encode(JSON.stringify(s)));__adianti_ajax_exec(m+"&id="+f+"&key="+f+"&start_time="+u+"&end_time="+p)}}).resizable({addClasses:false,delay:100,handles:"e,w",axis:"x",grid:[h,10],stop:function(e,t){e.stopPropagation();e.preventDefault();var a=$(this).data("ui-resizable").axis;if(a=="e"){var i=$(this).data("ui-resizable").size.width-$(this).data("ui-resizable").originalSize.width>0?"right":"left"}else{var i=$(this).data("ui-resizable").size.width-$(this).data("ui-resizable").originalSize.width<0?"right":"left"}var n=tgantt_get_time_resize(_,t);var r=JSON.parse(base64_decode(t.helper.attr("data")));var o=r.id;if(a=="w"){var l=new Date(r.start_time);if(i=="left"){l.setTime(l.getTime()-Math.abs(n)*60*60*1e3)}else{l.setTime(l.getTime()+Math.abs(n)*60*60*1e3)}var s=tgantt_format_date(l);var c=r.end_time}else{var l=new Date(r.end_time);if(i=="left"){l.setTime(l.getTime()-Math.abs(n)*60*60*1e3)}else{l.setTime(l.getTime()+Math.abs(n)*60*60*1e3)}var s=r.start_time;var c=tgantt_format_date(l)}r.start_time=s;r.end_time=c;t.helper.attr("data",base64_encode(JSON.stringify(r)));__adianti_ajax_exec(m+"&id="+o+"&key="+o+"&start_time="+s+"&end_time="+c)}})}function tgantt_update_data_title(e,t){if($(".tooltip").length<1){return false}var a=tgantt_get_time_drag(t);var i=$(".tooltip");var n=i.position().left;var r=$(e).data("lastHour");var o=$(e).data("pixelStep");if(r==a){return false}if(a>r){i.css("left",n+parseInt(o)+"px")}else{i.css("left",n-o+"px")}$(e).data("lastHour",a)}function tgantt_set_height(e){let t=[];$(e+" .table-content tr").each(function(){t.push($(this).outerHeight())});t.reverse();$(e+" .table-rows tr").each(function(){$(this).outerHeight(t.pop())})}function tgantt_get_steps(e){return e.position.left-e.originalPosition.left}function tgantt_get_time_drag(e,t){var a=tgantt_get_steps(t);var i=$(e).data("pixelStep");var n=$(e).data("minuteStep");if(a==0){return 0}return a/i*n/60}function tgantt_get_time_resize(e,t){var a=tgantt_get_time_drag(e,t);var i=$(e).data("pixelStep");var n=$(e).data("minuteStep");if(a!=0){return a}var r=t.size.width-t.originalSize.width;if(r==0){return 0}return r/i*n/60}Adianti.translation={en:{large_file:"The file is too large. The upload limit is ",success:"Success"},pt:{large_file:"O arquivo  muito grande. O limite de carregamento  ",success:"Sucesso"},es:{large_file:"El archivo es demasiado grande. El lmite de carga es ",success:"xito"}};function _t(e){return Adianti.translation[Adianti.language][e]??e}function tlikertscale_enable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).attr("onclick",null);$(a).css("pointer-events","auto");$(a).closest(".likert-wrapper").removeClass("tfield_block_events")},1)}function tlikertscale_disable_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).attr("onclick","return false");$(a).css("pointer-events","none");$(a).closest(".likert-wrapper").addClass("tfield_block_events")},1)}function tlikertscale_clear_field(e,t){var a=tfield_get_selector(e,t);setTimeout(function(){$(a).attr("checked",false)},1)}function tlikertscale_reload(e,t,a){$("form[name="+e+"] [tlikertscale="+t+"]").replaceWith(a)}function tmulticombo_enable_field(e,t){let a=tfield_get_selector(e,t+"[]");$(function(){try{$(a).multiselect("disable",false)}catch(e){console.log(e)}})}function tmulticombo_disable_field(e,t){let a=tfield_get_selector(e,t+"[]");$(function(){try{$(a).multiselect("disable",true)}catch(e){console.log(e)}})}function tmulticombo_start(e,t,a){$(function(){$("#"+e).multiselect({columns:1,search:true,texts:a,selectAll:true,maxHeight:400,onControlOpen:function(){setTimeout(function(){$("#"+e).parent().find('.ms-options input[type="text"]')[0].focus()},1)},optionAttributes:["disabled"]});$("#"+e).data("size",t);$("#"+e).next(".ms-options-wrap").width(t)})}function tmulticombo_reload(e,t){if(typeof e!="undefined"&&e!=""){form_name_sel='form[name="'+e+'"] '}else{form_name_sel=""}var a=form_name_sel+'[name="'+t+'[]"]';$(a).multiselect("reload");$(a).next(".ms-options-wrap").width($(a).data("size"))}function card_toggle_collapse(e){if($(e).closest(".card").find(".card-body:visible").length>0){$(e).closest(".card").find(".card-body").hide();$(e).find("i").removeClass("fa-chevron-up");$(e).find("i").addClass("fa-chevron-down")}else{$(e).closest(".card").find(".card-body").show();$(e).find("i").addClass("fa-chevron-up");$(e).find("i").removeClass("fa-chevron-down")}}
