!function(v){var o={columns:1,search:!1,searchOptions:{delay:250,showOptGroups:!1,searchText:!0,searchValue:!1,onSearch:function(t){}},texts:{placeholder:"Select options",search:"Search",searchNoResult:"No results",selectedOptions:" selected",selectAll:"Select all",unselectAll:"Unselect all",noneSelected:"None Selected"},selectAll:!1,selectGroup:!1,minHeight:200,maxHeight:null,maxWidth:null,maxPlaceholderWidth:null,maxPlaceholderOpts:10,showCheckbox:!0,checkboxAutoFit:!1,optionAttributes:[],replacePlaceholderText:!0,onLoad:function(t){},onOptionClick:function(t,e){},onControlOpen:function(t){},onControlClose:function(t){},onSelectAll:function(t,e){},onPlaceholder:function(t,e,o){}},s=1,n=1;function MultiSelect(t,e){if(this.element=t,this.options=v.extend(!0,{},o,e),this.updateSelectAll=!0,this.updatePlaceholder=!0,this.listNumber=s,s+=1,!v(this.element).attr("multiple"))throw new Error("[jQuery-MultiSelect] Select list must be a multiselect list in order to use this plugin");if(this.options.search&&!this.options.searchOptions.searchText&&!this.options.searchOptions.searchValue)throw new Error("[jQuery-MultiSelect] Either searchText or searchValue should be true.");"placeholder"in this.options&&(this.options.texts.placeholder=this.options.placeholder,delete this.options.placeholder),"default"in this.options.searchOptions&&(this.options.texts.search=this.options.searchOptions.default,delete this.options.searchOptions.default),this.load()}"function"!=typeof Array.prototype.map&&(Array.prototype.map=function(t,e){return v.isArray(e=void 0===e?this:e)?v.map(e,t):[]}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),MultiSelect.prototype={load:function(){var i=this;if("SELECT"!=i.element.nodeName||v(i.element).hasClass("jqmsLoaded"))return!0;v(i.element).addClass("jqmsLoaded ms-list-"+i.listNumber).data("plugin_multiselect-instance",i),v(i.element).after('<div id="ms-list-'+i.listNumber+'" class="ms-options-wrap"><button type="button"><span>None Selected</span></button><div class="ms-options"><ul></ul></div></div>');var t,o,e=v(i.element).siblings("#ms-list-"+i.listNumber+".ms-options-wrap").find("> button:first-child"),s=v(i.element).siblings("#ms-list-"+i.listNumber+".ms-options-wrap").find("> .ms-options"),n=s.find("> ul");i.options.showCheckbox?i.options.checkboxAutoFit&&s.addClass("checkbox-autofit"):s.addClass("hide-checkbox"),v(i.element).prop("disabled")&&e.prop("disabled",!0),i.options.maxPlaceholderWidth&&e.css("maxWidth",i.options.maxPlaceholderWidth),t=(t=i.options.maxHeight||v(window).height()-s.offset().top+v(window).scrollTop()-20)<i.options.minHeight?i.options.minHeight:t,s.css({maxWidth:i.options.maxWidth,minHeight:i.options.minHeight,maxHeight:t}),s.on("touchmove mousewheel DOMMouseScroll",function(t){var e;v(this).outerHeight()<v(this)[0].scrollHeight&&(e=(e=t.originalEvent).wheelDelta||-e.detail,v(this).outerHeight()+v(this)[0].scrollTop>v(this)[0].scrollHeight&&(t.preventDefault(),this.scrollTop+=e<0?1:-1))}),v(document).off("click.ms-hideopts").on("click.ms-hideopts",function(t){v(t.target).closest(".ms-options-wrap").length||v(".ms-options-wrap.ms-active > .ms-options").each(function(){v(this).closest(".ms-options-wrap").removeClass("ms-active");var t=v(this).closest(".ms-options-wrap").attr("id"),t=v(this).parent().siblings("."+t+".jqmsLoaded").data("plugin_multiselect-instance");"function"==typeof t.options.onControlClose&&t.options.onControlClose(t.element)})}).on("keydown",function(t){27==(t.keyCode||t.which)&&v(this).trigger("click.ms-hideopts")}),e.on("keydown",function(t){t=t.keyCode||t.which;13!=t&&32!=t||e.trigger("mousedown")}),e.on("mousedown",function(t){return!(!t.which||1==t.which)||(v(".ms-options-wrap.ms-active").each(function(){var t;v(this).siblings("."+v(this).attr("id")+".jqmsLoaded")[0]!=s.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded")[0]&&(v(this).removeClass("ms-active"),"function"==typeof(t=v(this).siblings("."+v(this).attr("id")+".jqmsLoaded").data("plugin_multiselect-instance")).options.onControlClose&&t.options.onControlClose(t.element))}),s.closest(".ms-options-wrap").toggleClass("ms-active"),void(s.closest(".ms-options-wrap").hasClass("ms-active")?("function"==typeof i.options.onControlOpen&&i.options.onControlOpen(i.element),s.css("maxHeight",""),(t=i.options.maxHeight||v(window).height()-s.offset().top+v(window).scrollTop()-20)&&(t=t<i.options.minHeight?i.options.minHeight:t,s.css("maxHeight",t))):"function"==typeof i.options.onControlClose&&i.options.onControlClose(i.element)))}).click(function(t){t.preventDefault()}),i.options.texts.placeholder&&e.find("span").text(i.options.texts.placeholder),i.options.search&&(n.before('<div class="ms-search"><input type="text" value="" placeholder="'+i.options.texts.search+'" /></div>'),n.after('<div class="no-result-message">'+i.options.texts.searchNoResult+"</div>"),(o=s.find(".ms-search input")).on("keyup",function(){if(v(this).data("lastsearch")==v(this).val())return!0;v(this).data("searchTimeout")&&clearTimeout(v(this).data("searchTimeout"));var e=v(this);v(this).data("searchTimeout",setTimeout(function(){e.data("lastsearch",e.val()),"function"==typeof i.options.searchOptions.onSearch&&i.options.searchOptions.onSearch(i.element);var t=v.trim(o.val().toLowerCase());t?(n.find('li[data-search-term*="'+t+'"]:not(.optgroup)').removeClass("ms-hidden"),n.find('li:not([data-search-term*="'+t+'"], .optgroup)').addClass("ms-hidden")):n.find(".ms-hidden").removeClass("ms-hidden"),i.options.searchOptions.showOptGroups||n.find(".optgroup").each(function(){v(this).find("li:not(.ms-hidden)").length?v(this).show():v(this).hide()}),i._updateSelectAllText()},i.options.searchOptions.delay))})),i.options.selectAll&&n.before('<a href="#" class="ms-selectall global">'+i.options.texts.selectAll+"</a>"),s.on("click",".ms-selectall",function(t){t.preventDefault(),i.updateSelectAll=!1,i.updatePlaceholder=!1;var e=s.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded");v(this).hasClass("global")?n.find('li:not(.optgroup, .selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').length?(n.find('li:not(.optgroup, .selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').closest("li").addClass("selected"),n.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",!0)):(n.find('li:not(.optgroup, .ms-hidden).selected input[type="checkbox"]:not(:disabled)').closest("li").removeClass("selected"),n.find('li:not(.optgroup, .ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",!1)):v(this).closest("li").hasClass("optgroup")&&((t=v(this).closest("li.optgroup")).find('li:not(.selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').length?(t.find('li:not(.selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').closest("li").addClass("selected"),t.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",!0)):(t.find('li:not(.ms-hidden).selected input[type="checkbox"]:not(:disabled)').closest("li").removeClass("selected"),t.find('li:not(.ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",!1)));var o=[];n.find('li.selected input[type="checkbox"]').each(function(){o.push(v(this).val())}),e.val(o).trigger("change"),i.updateSelectAll=!0,i.updatePlaceholder=!0,"function"==typeof i.options.onSelectAll&&i.options.onSelectAll(i.element,o.length),i._updateSelectAllText(),i._updatePlaceholderText()});var l=[];v(i.element).children().each(function(){if("OPTGROUP"==this.nodeName){var s=[];v(this).children("option").each(function(){for(var t={},e=0;e<i.options.optionAttributes.length;e++){var o=i.options.optionAttributes[e];void 0!==v(this).attr(o)&&(t[o]=v(this).attr(o))}s.push({name:v(this).text(),value:v(this).val(),checked:v(this).prop("selected"),attributes:t})}),l.push({label:v(this).attr("label"),options:s})}else{if("OPTION"!=this.nodeName)return!0;for(var t={},e=0;e<i.options.optionAttributes.length;e++){var o=i.options.optionAttributes[e];void 0!==v(this).attr(o)&&(t[o]=v(this).attr(o))}l.push({name:v(this).text(),value:v(this).val(),checked:v(this).prop("selected"),attributes:t})}}),i.loadOptions(l,!0,!1),s.on("click",'input[type="checkbox"]',function(){v(this).closest("li").toggleClass("selected"),s.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded").find('option[value="'+i._escapeSelector(v(this).val())+'"]').prop("selected",v(this).is(":checked")).closest("select").trigger("change"),"function"==typeof i.options.onOptionClick&&i.options.onOptionClick(i.element,this),i._updateSelectAllText(),i._updatePlaceholderText()}),s.on("focusin",'input[type="checkbox"]',function(){v(this).closest("label").addClass("focused")}).on("focusout",'input[type="checkbox"]',function(){v(this).closest("label").removeClass("focused")}),"function"==typeof i.options.onLoad&&i.options.onLoad(i.element),v(i.element).hide()},loadOptions:function(t,e,o){e="boolean"!=typeof e||e,o="boolean"!=typeof o||o;var s=this,i=v(s.element),n=i.siblings("#ms-list-"+s.listNumber+".ms-options-wrap").find("> .ms-options > ul"),l=i.siblings("#ms-list-"+s.listNumber+".ms-options-wrap").find("> .ms-options");e&&(n.find("> li").remove(),o&&i.find("> *").remove());var a,c,p=[];for(a in t)if(t.hasOwnProperty(a)){var r=t[a],h=v("<li/>"),d=!0;if(r.hasOwnProperty("value"))s.options.showCheckbox&&s.options.checkboxAutoFit&&h.addClass("ms-reflow"),s._addOption(h,r),o&&(b=v("<option/>",{value:r.value,text:r.name}),r.hasOwnProperty("attributes")&&Object.keys(r.attributes).length&&b.attr(r.attributes),r.checked&&b.prop("selected",!0),i.append(b));else{if(!r.hasOwnProperty("options"))continue;var u,m,f,b,g=v("<optgroup/>",{label:r.label});for(u in n.find("> li.optgroup > span.label").each(function(){v(this).text()==r.label&&(h=v(this).closest(".optgroup"),d=!1)}),o&&(i.find('optgroup[label="'+r.label+'"]').length?g=i.find('optgroup[label="'+r.label+'"]'):i.append(g)),d&&(h.addClass("optgroup"),h.append('<span class="label">'+r.label+"</span>"),h.find("> .label").css({clear:"both"}),s.options.selectGroup&&h.append('<a href="#" class="ms-selectall">'+s.options.texts.selectAll+"</a>"),h.append("<ul/>")),r.options)r.options.hasOwnProperty(u)&&(m=r.options[u],f=v("<li/>"),s.options.showCheckbox&&s.options.checkboxAutoFit&&f.addClass("ms-reflow"),m.hasOwnProperty("value")&&(s._addOption(f,m),h.find("> ul").append(f),o&&(b=v("<option/>",{value:m.value,text:m.name}),m.hasOwnProperty("attributes")&&Object.keys(m.attributes).length&&b.attr(m.attributes),m.checked&&b.prop("selected",!0),g.append(b))))}d&&p.push(h)}n.append(p),!s.options.checkboxAutoFit||!s.options.showCheckbox||l.hasClass("hide-checkbox")||(c=n.find('.ms-reflow:eq(0) input[type="checkbox"]')).length&&(e=(e=c.outerWidth())||15,n.find(".ms-reflow label").css("padding-left",2*parseInt(c.closest("label").css("padding-left"))+e),n.find(".ms-reflow").removeClass("ms-reflow")),s._updatePlaceholderText(),l.find("ul").css({"column-count":"","column-gap":"","-webkit-column-count":"","-webkit-column-gap":"","-moz-column-count":"","-moz-column-gap":""}),i.find("optgroup").length?(n.find("> li:not(.optgroup)").css({float:"left",width:100/s.options.columns+"%"}),n.find("li.optgroup").css({clear:"both"}).find("> ul").css({"column-count":s.options.columns,"column-gap":0,"-webkit-column-count":s.options.columns,"-webkit-column-gap":0,"-moz-column-count":s.options.columns,"-moz-column-gap":0}),this._ieVersion()&&this._ieVersion()<10&&n.find("li.optgroup > ul > li").css({float:"left",width:100/s.options.columns+"%"})):(n.css({"column-count":s.options.columns,"column-gap":0,"-webkit-column-count":s.options.columns,"-webkit-column-gap":0,"-moz-column-count":s.options.columns,"-moz-column-gap":0}),this._ieVersion()&&this._ieVersion()<10&&n.find("> li").css({float:"left",width:100/s.options.columns+"%"})),s._updateSelectAllText()},settings:function(t){this.options=v.extend(!0,{},this.options,t),this.reload()},unload:function(){v(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").remove(),v(this.element).show(function(){v(this).css("display","").removeClass("jqmsLoaded")})},reload:function(){v(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").remove(),v(this.element).removeClass("jqmsLoaded"),this.load()},reset:function(){var t=[];v(this.element).find("option").each(function(){v(this).prop("defaultSelected")&&t.push(v(this).val())}),v(this.element).val(t),this.reload()},disable:function(t){t="boolean"!=typeof t||t,v(this.element).prop("disabled",t),v(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").find("button:first-child").prop("disabled",t)},_updateSelectAllText:function(){var e,t,o;!this.updateSelectAll||((e=this).options.selectAll||e.options.selectGroup)&&((t=v(e.element).siblings("#ms-list-"+e.listNumber+".ms-options-wrap").find("> .ms-options")).find(".ms-selectall").each(function(){var t=v(this).parent().find("li:not(.optgroup,.selected,.ms-hidden)");v(this).text(t.length?e.options.texts.selectAll:e.options.texts.unselectAll)}),o=t.find("> ul li:not(.optgroup,.ms-hidden)").length,t.find(".no-result-message").toggle(!o),t.find(".ms-selectall.global").toggle(!!o))},_updatePlaceholderText:function(){if(this.updatePlaceholder){var t=this,e=v(t.element),o=e.val()?e.val():[],s=e.siblings("#ms-list-"+t.listNumber+".ms-options-wrap").find("> button:first-child"),i=s.find("span"),n=e.siblings("#ms-list-"+t.listNumber+".ms-options-wrap").find("> .ms-options");e.find("option:selected:disabled").length&&(o=[],e.find("option:selected").each(function(){o.push(v(this).val())}));var l,a=[];for(l in o)if(o.hasOwnProperty(l)&&(a.push(v.trim(e.find('option[value="'+t._escapeSelector(o[l])+'"]').text())),a.length>=t.options.maxPlaceholderOpts))break;i.text(a.join(", ")),a.length?(n.closest(".ms-options-wrap").addClass("ms-has-selections"),"function"==typeof t.options.onPlaceholder&&t.options.onPlaceholder(t.element,i,a)):n.closest(".ms-options-wrap").removeClass("ms-has-selections"),a.length?t.options.replacePlaceholderText&&(i.width()>s.width()||a.length!=o.length)&&i.text(o.length+t.options.texts.selectedOptions):i.text(t.options.texts.placeholder)}},_addOption:function(t,e){var o=v("<div/>").html(e.name).text(),s=v("<label/>",{for:"ms-opt-"+n}).text(o),i=v("<input>",{type:"checkbox",title:o,id:"ms-opt-"+n,value:e.value});e.hasOwnProperty("attributes")&&Object.keys(e.attributes).length&&i.attr(e.attributes),e.checked&&(t.addClass("default selected"),i.prop("checked",!0)),s.prepend(i);i="";this.options.searchOptions.searchText&&(i+=" "+o.toLowerCase()),this.options.searchOptions.searchValue&&(i+=" "+e.value.toLowerCase()),t.attr("data-search-term",v.trim(i)).prepend(s),n+=1},_ieVersion:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")&&parseInt(t.split("msie")[1])},_escapeSelector:function(t){return"function"==typeof v.escapeSelector?v.escapeSelector(t):t.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}},v.fn.multiselect=function(e){if(this.length){var o,s=arguments;return void 0===e||"object"==typeof e?this.each(function(){v.data(this,"plugin_multiselect")||v.data(this,"plugin_multiselect",new MultiSelect(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?(this.each(function(){var t=v.data(this,"plugin_multiselect");t instanceof MultiSelect&&"function"==typeof t[e]&&(o=t[e].apply(t,Array.prototype.slice.call(s,1))),"unload"===e&&v.data(this,"plugin_multiselect",null)}),o):void 0}}}(jQuery);
