(function(x){var s={columns:1,search:false,searchOptions:{delay:250,showOptGroups:false,searchText:true,searchValue:false,onSearch:function(e){}},texts:{placeholder:"Select options",search:"Search",searchNoResult:"No results",selectedOptions:" selected",selectAll:"Select all",unselectAll:"Unselect all",noneSelected:"None Selected"},selectAll:false,selectGroup:false,minHeight:200,maxHeight:null,maxWidth:null,maxPlaceholderWidth:null,maxPlaceholderOpts:10,showCheckbox:true,checkboxAutoFit:false,optionAttributes:[],replacePlaceholderText:true,onLoad:function(e){},onOptionClick:function(e,t){},onControlOpen:function(e){},onControlClose:function(e){},onSelectAll:function(e,t){},onPlaceholder:function(e,t,s){}};var o=1;var a=1;if(typeof Array.prototype.map!=="function"){Array.prototype.map=function(e,t){if(typeof t==="undefined"){t=this}return x.isArray(t)?x.map(t,e):[]}}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function i(e,t){this.element=e;this.options=x.extend(true,{},s,t);this.updateSelectAll=true;this.updatePlaceholder=true;this.listNumber=o;o=o+1;if(!x(this.element).attr("multiple")){throw new Error("[jQuery-MultiSelect] Select list must be a multiselect list in order to use this plugin")}if(this.options.search){if(!this.options.searchOptions.searchText&&!this.options.searchOptions.searchValue){throw new Error("[jQuery-MultiSelect] Either searchText or searchValue should be true.")}}if("placeholder"in this.options){this.options.texts.placeholder=this.options.placeholder;delete this.options.placeholder}if("default"in this.options.searchOptions){this.options.texts.search=this.options.searchOptions["default"];delete this.options.searchOptions["default"]}this.load()}i.prototype={load:function(){var i=this;if(i.element.nodeName!="SELECT"||x(i.element).hasClass("jqmsLoaded")){return true}x(i.element).addClass("jqmsLoaded ms-list-"+i.listNumber).data("plugin_multiselect-instance",i);x(i.element).after('<div id="ms-list-'+i.listNumber+'" class="ms-options-wrap"><button type="button"><span>None Selected</span></button><div class="ms-options"><ul></ul></div></div>');var s=x(i.element).siblings("#ms-list-"+i.listNumber+".ms-options-wrap").find("> button:first-child");var n=x(i.element).siblings("#ms-list-"+i.listNumber+".ms-options-wrap").find("> .ms-options");var l=n.find("> ul");if(!i.options.showCheckbox){n.addClass("hide-checkbox")}else if(i.options.checkboxAutoFit){n.addClass("checkbox-autofit")}if(x(i.element).prop("disabled")){s.prop("disabled",true)}if(i.options.maxPlaceholderWidth){s.css("maxWidth",i.options.maxPlaceholderWidth)}if(i.options.maxHeight){var e=i.options.maxHeight}else{var e=x(window).height()-n.offset().top+x(window).scrollTop()-20}e=e<i.options.minHeight?i.options.minHeight:e;n.css({maxWidth:i.options.maxWidth,minHeight:i.options.minHeight,maxHeight:e});n.on("touchmove mousewheel DOMMouseScroll",function(e){if(x(this).outerHeight()<x(this)[0].scrollHeight){var t=e.originalEvent,s=t.wheelDelta||-t.detail;if(x(this).outerHeight()+x(this)[0].scrollTop>x(this)[0].scrollHeight){e.preventDefault();this.scrollTop+=s<0?1:-1}}});x(document).off("click.ms-hideopts").on("click.ms-hideopts",function(e){if(!x(e.target).closest(".ms-options-wrap").length){x(".ms-options-wrap.ms-active > .ms-options").each(function(){x(this).closest(".ms-options-wrap").removeClass("ms-active");var e=x(this).closest(".ms-options-wrap").attr("id");var t=x(this).parent().siblings("."+e+".jqmsLoaded").data("plugin_multiselect-instance");if(typeof t.options.onControlClose=="function"){t.options.onControlClose(t.element)}})}}).on("keydown",function(e){if((e.keyCode||e.which)==27){x(this).trigger("click.ms-hideopts")}});s.on("keydown",function(e){var t=e.keyCode||e.which;if(t==13||t==32){s.trigger("mousedown")}});s.on("mousedown",function(e){if(e.which&&e.which!=1){return true}x(".ms-options-wrap.ms-active").each(function(){if(x(this).siblings("."+x(this).attr("id")+".jqmsLoaded")[0]!=n.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded")[0]){x(this).removeClass("ms-active");var e=x(this).siblings("."+x(this).attr("id")+".jqmsLoaded").data("plugin_multiselect-instance");if(typeof e.options.onControlClose=="function"){e.options.onControlClose(e.element)}}});n.closest(".ms-options-wrap").toggleClass("ms-active");if(n.closest(".ms-options-wrap").hasClass("ms-active")){if(typeof i.options.onControlOpen=="function"){i.options.onControlOpen(i.element)}n.css("maxHeight","");if(i.options.maxHeight){var t=i.options.maxHeight}else{var t=x(window).height()-n.offset().top+x(window).scrollTop()-20}if(t){t=t<i.options.minHeight?i.options.minHeight:t;n.css("maxHeight",t)}}else if(typeof i.options.onControlClose=="function"){i.options.onControlClose(i.element)}}).click(function(e){e.preventDefault()});if(i.options.texts.placeholder){s.find("span").text(i.options.texts.placeholder)}if(i.options.search){l.before('<div class="ms-search"><input type="text" value="" placeholder="'+i.options.texts.search+'" /></div>');l.after('<div class="no-result-message">'+i.options.texts.searchNoResult+"</div>");var o=n.find(".ms-search input");o.on("keyup",function(){if(x(this).data("lastsearch")==x(this).val()){return true}if(x(this).data("searchTimeout")){clearTimeout(x(this).data("searchTimeout"))}var t=x(this);x(this).data("searchTimeout",setTimeout(function(){t.data("lastsearch",t.val());if(typeof i.options.searchOptions.onSearch=="function"){i.options.searchOptions.onSearch(i.element)}var e=x.trim(o.val().toLowerCase());if(e){l.find('li[data-search-term*="'+e+'"]:not(.optgroup)').removeClass("ms-hidden");l.find('li:not([data-search-term*="'+e+'"], .optgroup)').addClass("ms-hidden")}else{l.find(".ms-hidden").removeClass("ms-hidden")}if(!i.options.searchOptions.showOptGroups){l.find(".optgroup").each(function(){if(x(this).find("li:not(.ms-hidden)").length){x(this).show()}else{x(this).hide()}})}i._updateSelectAllText()},i.options.searchOptions.delay))})}if(i.options.selectAll){l.before('<a href="#" class="ms-selectall global">'+i.options.texts.selectAll+"</a>")}n.on("click",".ms-selectall",function(e){e.preventDefault();i.updateSelectAll=false;i.updatePlaceholder=false;var t=n.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded");if(x(this).hasClass("global")){if(l.find('li:not(.optgroup, .selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').length){l.find('li:not(.optgroup, .selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').closest("li").addClass("selected");l.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",true)}else{l.find('li:not(.optgroup, .ms-hidden).selected input[type="checkbox"]:not(:disabled)').closest("li").removeClass("selected");l.find('li:not(.optgroup, .ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",false)}}else if(x(this).closest("li").hasClass("optgroup")){var s=x(this).closest("li.optgroup");if(s.find('li:not(.selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').length){s.find('li:not(.selected, .ms-hidden) input[type="checkbox"]:not(:disabled)').closest("li").addClass("selected");s.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",true)}else{s.find('li:not(.ms-hidden).selected input[type="checkbox"]:not(:disabled)').closest("li").removeClass("selected");s.find('li:not(.ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",false)}}var o=[];l.find('li.selected input[type="checkbox"]').each(function(){o.push(x(this).val())});t.val(o).trigger("change");i.updateSelectAll=true;i.updatePlaceholder=true;if(typeof i.options.onSelectAll=="function"){i.options.onSelectAll(i.element,o.length)}i._updateSelectAllText();i._updatePlaceholderText()});var a=[];x(i.element).children().each(function(){if(this.nodeName=="OPTGROUP"){var o=[];x(this).children("option").each(function(){var e={};for(var t=0;t<i.options.optionAttributes.length;t++){var s=i.options.optionAttributes[t];if(x(this).attr(s)!==undefined){e[s]=x(this).attr(s)}}o.push({name:x(this).text(),value:x(this).val(),checked:x(this).prop("selected"),attributes:e})});a.push({label:x(this).attr("label"),options:o})}else if(this.nodeName=="OPTION"){var e={};for(var t=0;t<i.options.optionAttributes.length;t++){var s=i.options.optionAttributes[t];if(x(this).attr(s)!==undefined){e[s]=x(this).attr(s)}}a.push({name:x(this).text(),value:x(this).val(),checked:x(this).prop("selected"),attributes:e})}else{return true}});i.loadOptions(a,true,false);n.on("click",'input[type="checkbox"]',function(){x(this).closest("li").toggleClass("selected");var e=n.parent().siblings(".ms-list-"+i.listNumber+".jqmsLoaded");e.find('option[value="'+i._escapeSelector(x(this).val())+'"]').prop("selected",x(this).is(":checked")).closest("select").trigger("change");if(typeof i.options.onOptionClick=="function"){i.options.onOptionClick(i.element,this)}i._updateSelectAllText();i._updatePlaceholderText()});n.on("focusin",'input[type="checkbox"]',function(){x(this).closest("label").addClass("focused")}).on("focusout",'input[type="checkbox"]',function(){x(this).closest("label").removeClass("focused")});if(typeof i.options.onLoad==="function"){i.options.onLoad(i.element)}x(i.element).hide()},loadOptions:function(e,t,s){t=typeof t=="boolean"?t:true;s=typeof s=="boolean"?s:true;var o=this;var i=x(o.element);var n=i.siblings("#ms-list-"+o.listNumber+".ms-options-wrap").find("> .ms-options > ul");var l=i.siblings("#ms-list-"+o.listNumber+".ms-options-wrap").find("> .ms-options");if(t){n.find("> li").remove();if(s){i.find("> *").remove()}}var a=[];for(var r in e){if(!e.hasOwnProperty(r)){continue}var p=e[r];var c=x("<li/>");var d=true;if(p.hasOwnProperty("value")){if(o.options.showCheckbox&&o.options.checkboxAutoFit){c.addClass("ms-reflow")}o._addOption(c,p);if(s){var h=x("<option/>",{value:p.value,text:p.name});if(p.hasOwnProperty("attributes")&&Object.keys(p.attributes).length){h.attr(p.attributes)}if(p.checked){h.prop("selected",true)}i.append(h)}}else if(p.hasOwnProperty("options")){var u=x("<optgroup/>",{label:p.label});n.find("> li.optgroup > span.label").each(function(){if(x(this).text()==p.label){c=x(this).closest(".optgroup");d=false}});if(s){if(i.find('optgroup[label="'+p.label+'"]').length){u=i.find('optgroup[label="'+p.label+'"]')}else{i.append(u)}}if(d){c.addClass("optgroup");c.append('<span class="label">'+p.label+"</span>");c.find("> .label").css({clear:"both"});if(o.options.selectGroup){c.append('<a href="#" class="ms-selectall">'+o.options.texts.selectAll+"</a>")}c.append("<ul/>")}for(var f in p.options){if(!p.options.hasOwnProperty(f)){continue}var m=p.options[f];var b=x("<li/>");if(o.options.showCheckbox&&o.options.checkboxAutoFit){b.addClass("ms-reflow")}if(!m.hasOwnProperty("value")){continue}o._addOption(b,m);c.find("> ul").append(b);if(s){var h=x("<option/>",{value:m.value,text:m.name});if(m.hasOwnProperty("attributes")&&Object.keys(m.attributes).length){h.attr(m.attributes)}if(m.checked){h.prop("selected",true)}u.append(h)}}}else{continue}if(d){a.push(c)}}n.append(a);if(o.options.checkboxAutoFit&&o.options.showCheckbox&&!l.hasClass("hide-checkbox")){var g=n.find('.ms-reflow:eq(0) input[type="checkbox"]');if(g.length){var v=g.outerWidth();v=v?v:15;n.find(".ms-reflow label").css("padding-left",parseInt(g.closest("label").css("padding-left"))*2+v);n.find(".ms-reflow").removeClass("ms-reflow")}}o._updatePlaceholderText();l.find("ul").css({"column-count":"","column-gap":"","-webkit-column-count":"","-webkit-column-gap":"","-moz-column-count":"","-moz-column-gap":""});if(i.find("optgroup").length){n.find("> li:not(.optgroup)").css({float:"left",width:100/o.options.columns+"%"});n.find("li.optgroup").css({clear:"both"}).find("> ul").css({"column-count":o.options.columns,"column-gap":0,"-webkit-column-count":o.options.columns,"-webkit-column-gap":0,"-moz-column-count":o.options.columns,"-moz-column-gap":0});if(this._ieVersion()&&this._ieVersion()<10){n.find("li.optgroup > ul > li").css({float:"left",width:100/o.options.columns+"%"})}}else{n.css({"column-count":o.options.columns,"column-gap":0,"-webkit-column-count":o.options.columns,"-webkit-column-gap":0,"-moz-column-count":o.options.columns,"-moz-column-gap":0});if(this._ieVersion()&&this._ieVersion()<10){n.find("> li").css({float:"left",width:100/o.options.columns+"%"})}}o._updateSelectAllText()},settings:function(e){this.options=x.extend(true,{},this.options,e);this.reload()},unload:function(){x(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").remove();x(this.element).show(function(){x(this).css("display","").removeClass("jqmsLoaded")})},reload:function(){x(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").remove();x(this.element).removeClass("jqmsLoaded");this.load()},reset:function(){var e=[];x(this.element).find("option").each(function(){if(x(this).prop("defaultSelected")){e.push(x(this).val())}});x(this.element).val(e);this.reload()},disable:function(e){e=typeof e==="boolean"?e:true;x(this.element).prop("disabled",e);x(this.element).siblings("#ms-list-"+this.listNumber+".ms-options-wrap").find("button:first-child").prop("disabled",e)},_updateSelectAllText:function(){if(!this.updateSelectAll){return}var t=this;if(!t.options.selectAll&&!t.options.selectGroup){return}var e=x(t.element).siblings("#ms-list-"+t.listNumber+".ms-options-wrap").find("> .ms-options");e.find(".ms-selectall").each(function(){var e=x(this).parent().find("li:not(.optgroup,.selected,.ms-hidden)");x(this).text(e.length?t.options.texts.selectAll:t.options.texts.unselectAll)});var s=e.find("> ul li:not(.optgroup,.ms-hidden)").length;e.find(".no-result-message").toggle(s?false:true);e.find(".ms-selectall.global").toggle(s?true:false)},_updatePlaceholderText:function(){if(!this.updatePlaceholder){return}var e=this;var t=x(e.element);var s=t.val()?t.val():[];var o=t.siblings("#ms-list-"+e.listNumber+".ms-options-wrap").find("> button:first-child");var i=o.find("span");var n=t.siblings("#ms-list-"+e.listNumber+".ms-options-wrap").find("> .ms-options");if(t.find("option:selected:disabled").length){s=[];t.find("option:selected").each(function(){s.push(x(this).val())})}var l=[];for(var a in s){if(!s.hasOwnProperty(a)){continue}l.push(x.trim(t.find('option[value="'+e._escapeSelector(s[a])+'"]').text().replace(/<\/?[^>]+(>|$)/g,"")));if(l.length>=e.options.maxPlaceholderOpts){break}}i.text(l.join(", "));if(l.length){n.closest(".ms-options-wrap").addClass("ms-has-selections");if(typeof e.options.onPlaceholder=="function"){e.options.onPlaceholder(e.element,i,l)}}else{n.closest(".ms-options-wrap").removeClass("ms-has-selections")}if(!l.length){i.text(e.options.texts.placeholder)}else if(e.options.replacePlaceholderText&&(i.width()>o.width()||l.length!=s.length)){i.text(s.length+e.options.texts.selectedOptions)}},_addOption:function(e,t){var s=this;var o=x("<div/>").html(t.name).text();var i=x("<label/>",{for:"ms-opt-"+a});var n=x("<input>",{type:"checkbox",id:"ms-opt-"+a,value:t.value});if(t.hasOwnProperty("attributes")&&Object.keys(t.attributes).length){n.attr(t.attributes)}if(t.checked){e.addClass("default selected");n.prop("checked",true)}i.prepend(n);i.append(t.name);var l="";if(s.options.searchOptions.searchText){l+=" "+o.toLowerCase()}if(s.options.searchOptions.searchValue){l+=" "+t.value.toLowerCase()}e.attr("data-search-term",x.trim(l)).prepend(i);a=a+1},_ieVersion:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")!=-1?parseInt(e.split("msie")[1]):false},_escapeSelector:function(e){if(typeof x.escapeSelector=="function"){return x.escapeSelector(e)}else{return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}}};x.fn.multiselect=function(t){if(!this.length){return}var s=arguments;var o;if(t===undefined||typeof t==="object"){return this.each(function(){if(!x.data(this,"plugin_multiselect")){x.data(this,"plugin_multiselect",new i(this,t))}})}else if(typeof t==="string"&&t[0]!=="_"&&t!=="init"){this.each(function(){var e=x.data(this,"plugin_multiselect");if(e instanceof i&&typeof e[t]==="function"){o=e[t].apply(e,Array.prototype.slice.call(s,1))}if(t==="unload"){x.data(this,"plugin_multiselect",null)}});return o}}})(jQuery);
